<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.475">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Oh Jia Wen">
<meta name="dcterms.date" content="2023-12-11">

<title>Take Home Exercise 2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Take Home Exercise 2</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../"></a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://isss624-ohjiawen.netlify.app/" title="" class="sidebar-tool px-1"><i class="bi bi-house-fill"></i></a>
    <a href="https://www.linkedin.com/in/jia-wen-oh/" title="" class="sidebar-tool px-1"><i class="bi bi-linkedin"></i></a>
  <a href="" class="quarto-color-scheme-toggle sidebar-tool" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle sidebar-tool" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">Home</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">Hands-on Exercise</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html" class="sidebar-item-text sidebar-link">Exercise 1A: Geospatial Data Wrangling</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01b.html" class="sidebar-item-text sidebar-link">Exercise 1B: Choropleth Mapping</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02a.html" class="sidebar-item-text sidebar-link">Exercise 2A: Spatial Weights and Applications</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02b.html" class="sidebar-item-text sidebar-link">Exercise 2B: Global Measures of Spatial Autocorrelation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02c.html" class="sidebar-item-text sidebar-link">Exercise 2C: Local Measures of Spatial Autocorrelation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex03.html" class="sidebar-item-text sidebar-link">Exercise 3: Processing and Visualizing Flow Data</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">In-class Exercise</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../In-class_Ex/In-class_Ex01/In-class_Ex01.html" class="sidebar-item-text sidebar-link">In-class Exercise 1</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../In-class_Ex/In-class_Ex02/In-class_Ex02.html" class="sidebar-item-text sidebar-link">In-class Exercise 2</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../In-class_Ex/In-class_Ex03/In-class_Ex03.html" class="sidebar-item-text sidebar-link">In-class Exercise 3</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../In-class_Ex/In-class_Ex04/In-class_Ex04.html" class="sidebar-item-text sidebar-link">In-class Exercise 4</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../In-class_Ex/In-class_Ex05/In-class_Ex05.html" class="sidebar-item-text sidebar-link">In-class Exercise 5</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">Take Home Exercise</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Take-Home_Ex/Take-Home_Ex01/Take-Home_Ex01.html" class="sidebar-item-text sidebar-link">Take Home Exercise 1</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Take-Home_Ex/Take-Home_Ex02/Take-Home_Ex03.html" class="sidebar-item-text sidebar-link">Take Home Exercise 2</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">1. Overview</a>
  <ul class="collapse">
  <li><a href="#the-task" id="toc-the-task" class="nav-link" data-scroll-target="#the-task">1.1 The Task</a></li>
  </ul></li>
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation">2. Data preparation</a>
  <ul class="collapse">
  <li><a href="#install-r-packages" id="toc-install-r-packages" class="nav-link" data-scroll-target="#install-r-packages">2.1 Install R packages</a></li>
  <li><a href="#import-and-load-dataset" id="toc-import-and-load-dataset" class="nav-link" data-scroll-target="#import-and-load-dataset">2.2 Import and Load Dataset</a>
  <ul class="collapse">
  <li><a href="#importing-aspatial-data" id="toc-importing-aspatial-data" class="nav-link" data-scroll-target="#importing-aspatial-data">2.2.1 Importing Aspatial data</a></li>
  <li><a href="#importing-geospatial-data" id="toc-importing-geospatial-data" class="nav-link" data-scroll-target="#importing-geospatial-data">2.2.2 Importing Geospatial data</a></li>
  </ul></li>
  <li><a href="#data-wrangling" id="toc-data-wrangling" class="nav-link" data-scroll-target="#data-wrangling">2.3 Data Wrangling</a>
  <ul class="collapse">
  <li><a href="#data-extraction" id="toc-data-extraction" class="nav-link" data-scroll-target="#data-extraction">2.3.1 Data Extraction</a></li>
  <li><a href="#data-generation" id="toc-data-generation" class="nav-link" data-scroll-target="#data-generation">2.3.2 Data Generation</a></li>
  </ul></li>
  <li><a href="#data-integration" id="toc-data-integration" class="nav-link" data-scroll-target="#data-integration">3. Data Integration</a>
  <ul class="collapse">
  <li><a href="#importing-collected-data" id="toc-importing-collected-data" class="nav-link" data-scroll-target="#importing-collected-data">3.1 Importing Collected Data</a></li>
  <li><a href="#compute-point-in-polygon-count" id="toc-compute-point-in-polygon-count" class="nav-link" data-scroll-target="#compute-point-in-polygon-count">3.2 Compute point-in-polygon count</a></li>
  </ul></li>
  <li><a href="#distance-matrix" id="toc-distance-matrix" class="nav-link" data-scroll-target="#distance-matrix">4. Distance Matrix</a>
  <ul class="collapse">
  <li><a href="#prepare-flow-data" id="toc-prepare-flow-data" class="nav-link" data-scroll-target="#prepare-flow-data">Prepare flow data</a></li>
  <li><a href="#preparing-origin-attributes" id="toc-preparing-origin-attributes" class="nav-link" data-scroll-target="#preparing-origin-attributes">Preparing Origin Attributes</a></li>
  </ul></li>
  <li><a href="#count" id="toc-count" class="nav-link" data-scroll-target="#count">COUNT</a></li>
  <li><a href="#unconstrained-spatial-interaction-model" id="toc-unconstrained-spatial-interaction-model" class="nav-link" data-scroll-target="#unconstrained-spatial-interaction-model">Unconstrained Spatial Interaction Model</a></li>
  <li><a href="#r-squared-function" id="toc-r-squared-function" class="nav-link" data-scroll-target="#r-squared-function">R-squared function</a></li>
  <li><a href="#origin-production-constrained-sim" id="toc-origin-production-constrained-sim" class="nav-link" data-scroll-target="#origin-production-constrained-sim">Origin (Production) constrained SIM</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Take Home Exercise 2</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Oh Jia Wen </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 11, 2023</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">December 15, 2023</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="overview" class="level1">
<h1>1. Overview</h1>
<p>As city-wide urban infrastructures such as public bus, mass rapid transits, public utilities and roads become digital, data sets obtained could be used as a framework for tracking movement patterns through space and time.</p>
<section id="the-task" class="level2">
<h2 class="anchored" data-anchor-id="the-task">1.1 The Task</h2>
<p>This exercise aims to reveals the urban mobility patterns of public bus transit through geospatial data science and analysis (GDSA), and spatial interaction models.</p>
<p>The original data was downloaded on 18th November 2023 from <strong>LTA DataMall</strong> under Section 2.6 - <em>Passenger Volume by Origin Destination Bus Stops</em>. It records the number of trips by weekdays and weekends from origin to destination bus stops. For the purpose of this exercise, we will be using the <strong>August</strong> data - origin_destination_bus_202308.csv for <strong>Weekday Morning Peak (6-9am)</strong>.</p>
</section>
</section>
<section id="data-preparation" class="level1">
<h1>2. Data preparation</h1>
<section id="install-r-packages" class="level2">
<h2 class="anchored" data-anchor-id="install-r-packages">2.1 Install R packages</h2>
<p>The code chunk below uses <code>pacman:: p_load()</code> to load and install the following libraries:</p>
<ul>
<li><p><strong>`mlogit``</strong> : [to add]</p></li>
<li><p><strong>`reshape2``</strong> : [to add]</p></li>
<li><p><strong><code>sf</code></strong> : Used for geospatial data handling</p></li>
<li><p><code>spdep</code> : Used to create spatial weights matrix objects</p></li>
<li><p><strong><code>sfdep</code></strong> : Used to integrate with <code>'sf'</code> objects and the <code>'tidyverse'</code></p></li>
<li><p><strong><code>tidyverse</code></strong>: A collection of R packages use in everyday data analyses. It is able to support data science, data wrangling, and analysis</p></li>
<li><p><strong><code>tmap</code></strong> : Used for thematic mapping</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(pscl, reshape2, sp, sf, spdep, sfdep, stplanr, tidyverse, tmap)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="import-and-load-dataset" class="level2">
<h2 class="anchored" data-anchor-id="import-and-load-dataset">2.2 Import and Load Dataset</h2>
<p>Three data and a hexagon layer will be used for this study :</p>
<ul>
<li><p><code>origin_destination_bus_202308.csv</code> : A csv file containing information about all the bus stops currently being serviced by bus, which includes bus stop identifier, and location coordinates.</p></li>
<li><p><em><code>Bus Stop Location</code></em> . A geospatial file from LTA DataMall</p></li>
<li><p><code>Master Plan 2019 Subzone Boundary</code> : A polygon feature layer in ESRI shapefile format.</p></li>
</ul>
<section id="importing-aspatial-data" class="level3">
<h3 class="anchored" data-anchor-id="importing-aspatial-data">2.2.1 Importing Aspatial data</h3>
<p>First, we will import the <u>Passenger Volume by Origin Destination Bus Stops</u> data set for <strong>August</strong> by using <code>readr::read_csv()</code> and store it in variable <strong>odbus</strong>. Also, we will be using <code>glimpse()</code> report to reveal the data type of each field.</p>
<p><em>Point to note: <code>ORIGIN_PT_CODE</code> and <code>DESTINATION_PT_CODE</code> are in <code>&lt;chr&gt;</code> format.</em></p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>odbus <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/aspatial/origin_destination_bus_202308.csv"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(odbus)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 5,709,512
Columns: 7
$ YEAR_MONTH          &lt;chr&gt; "2023-08", "2023-08", "2023-08", "2023-08", "2023-…
$ DAY_TYPE            &lt;chr&gt; "WEEKDAY", "WEEKENDS/HOLIDAY", "WEEKENDS/HOLIDAY",…
$ TIME_PER_HOUR       &lt;dbl&gt; 16, 16, 14, 14, 17, 17, 17, 17, 7, 17, 14, 10, 10,…
$ PT_TYPE             &lt;chr&gt; "BUS", "BUS", "BUS", "BUS", "BUS", "BUS", "BUS", "…
$ ORIGIN_PT_CODE      &lt;chr&gt; "04168", "04168", "80119", "80119", "44069", "4406…
$ DESTINATION_PT_CODE &lt;chr&gt; "10051", "10051", "90079", "90079", "17229", "1722…
$ TOTAL_TRIPS         &lt;dbl&gt; 7, 2, 3, 10, 5, 4, 3, 22, 3, 3, 7, 1, 3, 1, 3, 1, …</code></pre>
</div>
</div>
</section>
<section id="importing-geospatial-data" class="level3">
<h3 class="anchored" data-anchor-id="importing-geospatial-data">2.2.2 Importing Geospatial data</h3>
<p>Thereafter, we will import the <u>Bus Stops</u> <u>Location</u> and <u>Master Plan 2019 Subzone Boundary</u>.</p>
<section id="import-bus-stop-data" class="level4">
<h4 class="anchored" data-anchor-id="import-bus-stop-data">2.2.2.1 Import Bus Stop data</h4>
<p>We will be using <code>sf::st_read()</code> to import and <code>sf::st_transform()</code> to ensure that the projected coordinate system is in the right format before storing in variable <strong>busstop</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>busstop <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial"</span>,<span class="at">layer =</span> <span class="st">"BusStop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `BusStop' from data source 
  `/Users/smu/Rworkshop/jiawenoh/ISSS624/Take-Home_Ex/Take-Home_Ex02/data/geospatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 5161 features and 3 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 3970.122 ymin: 26482.1 xmax: 48284.56 ymax: 52983.82
Projected CRS: SVY21</code></pre>
</div>
</div>
<p>Also, we will be using <code>glimpse()</code> report to reveal the data type of each field.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(busstop)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 5,161
Columns: 4
$ BUS_STOP_N &lt;chr&gt; "22069", "32071", "44331", "96081", "11561", "66191", "2338…
$ BUS_ROOF_N &lt;chr&gt; "B06", "B23", "B01", "B05", "B05", "B03", "B02A", "B02", "B…
$ LOC_DESC   &lt;chr&gt; "OPP CEVA LOGISTICS", "AFT TRACK 13", "BLK 239", "GRACE IND…
$ geometry   &lt;POINT [m]&gt; POINT (13576.31 32883.65), POINT (13228.59 44206.38),…</code></pre>
</div>
</div>
</section>
<section id="import-mpsz-data" class="level4">
<h4 class="anchored" data-anchor-id="import-mpsz-data">2.2.2.2 Import MPSZ data</h4>
<p>In addition, we will similar approach - <code>sf::st_read()</code> to import and <code>sf::st_transform()</code> to ensure that the projected coordinate system is in the right format before storing in variable <strong>mpsz</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>mpsz <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial"</span>,</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">layer =</span> <span class="st">"MPSZ-2019"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `MPSZ-2019' from data source 
  `/Users/smu/Rworkshop/jiawenoh/ISSS624/Take-Home_Ex/Take-Home_Ex02/data/geospatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 332 features and 6 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 103.6057 ymin: 1.158699 xmax: 104.0885 ymax: 1.470775
Geodetic CRS:  WGS 84</code></pre>
</div>
</div>
<p>We will be using <code>glimpse()</code> report to reveal the data type of each field</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(mpsz)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 332
Columns: 7
$ SUBZONE_N  &lt;chr&gt; "MARINA EAST", "INSTITUTION HILL", "ROBERTSON QUAY", "JURON…
$ SUBZONE_C  &lt;chr&gt; "MESZ01", "RVSZ05", "SRSZ01", "WISZ01", "MUSZ02", "MPSZ05",…
$ PLN_AREA_N &lt;chr&gt; "MARINA EAST", "RIVER VALLEY", "SINGAPORE RIVER", "WESTERN …
$ PLN_AREA_C &lt;chr&gt; "ME", "RV", "SR", "WI", "MU", "MP", "WI", "WI", "SI", "SI",…
$ REGION_N   &lt;chr&gt; "CENTRAL REGION", "CENTRAL REGION", "CENTRAL REGION", "WEST…
$ REGION_C   &lt;chr&gt; "CR", "CR", "CR", "WR", "CR", "CR", "WR", "WR", "CR", "CR",…
$ geometry   &lt;MULTIPOLYGON [m]&gt; MULTIPOLYGON (((33222.98 29..., MULTIPOLYGON (…</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="data-wrangling" class="level2">
<h2 class="anchored" data-anchor-id="data-wrangling">2.3 Data Wrangling</h2>
<p>Looking at section 2.2.1, we noticed a few problem:</p>
<ul>
<li><p><em><code>ORIGIN_PT_CODE</code></em> : is in <code>&lt;chr&gt;</code> format</p></li>
<li><p><em><code>DESTINATION_PT_CODE</code></em> : is in <code>&lt;chr&gt;</code> format</p></li>
</ul>
<p>We will be using <code>dplyr::mutate()</code> to convert the <code>&lt;chr&gt;</code> data type to <code>&lt;fct&gt;</code> and store it in a new variable <strong>odbus_new</strong>.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>odbus_new <span class="ot">&lt;-</span> odbus <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">mutate</span>(<span class="at">ORIGIN_PT_CODE =</span> <span class="fu">as.factor</span>(ORIGIN_PT_CODE),</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">DESTINATION_PT_CODE =</span> <span class="fu">as.factor</span>(DESTINATION_PT_CODE))</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(odbus_new)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 5,709,512
Columns: 7
$ YEAR_MONTH          &lt;chr&gt; "2023-08", "2023-08", "2023-08", "2023-08", "2023-…
$ DAY_TYPE            &lt;chr&gt; "WEEKDAY", "WEEKENDS/HOLIDAY", "WEEKENDS/HOLIDAY",…
$ TIME_PER_HOUR       &lt;dbl&gt; 16, 16, 14, 14, 17, 17, 17, 17, 7, 17, 14, 10, 10,…
$ PT_TYPE             &lt;chr&gt; "BUS", "BUS", "BUS", "BUS", "BUS", "BUS", "BUS", "…
$ ORIGIN_PT_CODE      &lt;fct&gt; 04168, 04168, 80119, 80119, 44069, 44069, 20281, 2…
$ DESTINATION_PT_CODE &lt;fct&gt; 10051, 10051, 90079, 90079, 17229, 17229, 20141, 2…
$ TOTAL_TRIPS         &lt;dbl&gt; 7, 2, 3, 10, 5, 4, 3, 22, 3, 3, 7, 1, 3, 1, 3, 1, …</code></pre>
</div>
</div>
<p>Additionally, we confirmed that there are no missing values in the <strong>odbus_new data set.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">is.na</span>(odbus_new))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
<section id="data-extraction" class="level3">
<h3 class="anchored" data-anchor-id="data-extraction">2.3.1 Data Extraction</h3>
<section id="analytical-hexagon" class="level4">
<h4 class="anchored" data-anchor-id="analytical-hexagon">2.3.1.1 Analytical Hexagon</h4>
<p>Thereafter, we will create the analytical hexagon grid. With reference from <a href="https://urbandatapalette.com/post/2021-08-tessellation-sf/">Urban Data Palette</a>, we will perform the following steps:</p>
<ul>
<li><p><code>st_make_grid()</code> : create a regular grid of spatial polygons. To reflect the distance from centre of the hexagon to its edge, we will revise the cell width and height to c(750,750).</p></li>
<li><p><code>st_sf()</code> : convert the honeycomb grid object to an sf object. We used <code>[mpsz$geometry]</code> to identify hexagon grid that intersects.</p></li>
<li><p><code>rowid_to_column()</code> : add rowid as a column</p></li>
<li><p><code>tmap_options(check.and.fix = TRUE)</code> : force close polygon</p></li>
</ul>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#create regular grid </span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>honeycomb <span class="ot">=</span> <span class="fu">st_make_grid</span>(mpsz,<span class="fu">c</span>(<span class="dv">750</span>,<span class="dv">750</span>),<span class="at">what =</span> <span class="st">"polygons"</span>, <span class="at">square =</span> <span class="cn">FALSE</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co">#convert our honeycomb grid into an sf object and add rowid</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>hex_grid <span class="ot">&lt;-</span> <span class="fu">st_sf</span>(honeycomb[mpsz<span class="sc">$</span>geometry]) <span class="sc">%&gt;%</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowid_to_column</span>(<span class="st">'grid_id'</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co">#add no. of bus stops into hex_grid data frame</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>hex_grid<span class="sc">$</span>bus_stops <span class="ot">=</span> <span class="fu">lengths</span>(<span class="fu">st_intersects</span>(hex_grid, busstop))</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="co">#convert grid_id from int to fct </span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>hex_grid<span class="sc">$</span>grid_id <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(hex_grid<span class="sc">$</span>grid_id)</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="co">#plotting of Master Plan 2019 Subzone Boundary in analytical hexagon</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_options</span>(<span class="at">check.and.fix =</span> <span class="cn">TRUE</span>) <span class="co">#force close polygon </span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(hex_grid) <span class="sc">+</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a> <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Analytical Hexagon Grid"</span>,</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="dv">1</span>,</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.height =</span> <span class="fl">0.35</span>, </span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width =</span> <span class="fl">0.35</span>,</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside =</span> <span class="cn">FALSE</span>,</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>),</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="commuting-flow" class="level4">
<h4 class="anchored" data-anchor-id="commuting-flow">2.3.1.2 Commuting Flow</h4>
<p>Through the previous <a href="https://isss624-ohjiawen.netlify.app/take-home_ex/take-home_ex01/take-home_ex01">exercise</a>, where we look into the various commuting flows, we noticed that there are various regions with high volume. As such, we will focus on our flow on <strong>Weekday Morning Peak (6-9am)</strong>.</p>
<p>The code is extracted in the following manner:</p>
<ul>
<li><p><code>filter()</code> is used to extract subset of data</p></li>
<li><p><code>between()</code> is used to express a range condition</p></li>
<li><p><code>group_by()</code> and <code>summarise()</code> are used to sum the total trips</p></li>
<li><p><code>arrange(desc())</code> to sort in descending order</p></li>
<li><p><code>ungroup()</code> is used to end a definition, often use with <code>group_by()</code></p></li>
</ul>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>wkd6_9 <span class="ot">&lt;-</span> odbus_new <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(DAY_TYPE <span class="sc">==</span> <span class="st">"WEEKDAY"</span>,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>         <span class="fu">between</span>(TIME_PER_HOUR, <span class="dv">6</span>, <span class="dv">9</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ORIGIN_PT_CODE, DESTINATION_PT_CODE) <span class="sc">%&gt;%</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TRIPS =</span> <span class="fu">sum</span>(TOTAL_TRIPS)) <span class="sc">%&gt;%</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(TRIPS)) <span class="sc">%&gt;%</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Thereafter, we will save a copy of the output in rds format and reload it into the environment.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(wkd6_9, <span class="st">"data/rds/wkd6_9.rds"</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>wkd6_9 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/wkd6_9.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="visualing-bus-stops-in-hexagon-grid" class="level4">
<h4 class="anchored" data-anchor-id="visualing-bus-stops-in-hexagon-grid">2.3.1.3 Visualing bus stops in hexagon grid</h4>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot bus stop counts on hexagon layer </span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(hex_grid) <span class="sc">+</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"bus_stops"</span>,<span class="at">palette =</span> <span class="st">"Purples"</span>) <span class="sc">+</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Number of Bus Stops in Hexagon Grid"</span>,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="dv">1</span>,</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.height =</span> <span class="fl">0.35</span>, </span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width =</span> <span class="fl">0.35</span>,</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside =</span> <span class="cn">FALSE</span>,</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>),</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span><span class="fl">0.3</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Insights:</strong></p>
<ul>
<li><p>Majority of the hexagonal grid contains 6 to 10 bus stops.</p></li>
<li><p>Bus stops that are closely position in the grid, tend to have neighbors with similar patterns.</p></li>
</ul>
</section>
</section>
<section id="data-generation" class="level3">
<h3 class="anchored" data-anchor-id="data-generation">2.3.2 Data Generation</h3>
<p>After extracting the commuting flow for Weekday Morning Peak, we will combine it into <strong>busstop</strong> sf data frame. To ensure distinct flows, we will use the <code>unique()</code> function into our code.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>busstop_mpsz <span class="ot">&lt;-</span> <span class="fu">st_intersection</span>(busstop, hex_grid) <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(BUS_STOP_N, grid_id) <span class="sc">%&gt;%</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_drop_geometry</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, we will update the <code>od_data</code> data frame with the planning subzone code.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>od_data <span class="ot">&lt;-</span> <span class="fu">left_join</span>(wkd6_9 , busstop_mpsz,</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"ORIGIN_PT_CODE"</span> <span class="ot">=</span> <span class="st">"BUS_STOP_N"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">ORIGIN_BS =</span> ORIGIN_PT_CODE,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">ORIGIN_ID =</span> grid_id,</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">DESTIN_BS =</span> DESTINATION_PT_CODE) <span class="sc">%&gt;%</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>() <span class="sc">%&gt;%</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>od_data <span class="ot">&lt;-</span> <span class="fu">left_join</span>(od_data , busstop_mpsz,</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"DESTIN_BS"</span> <span class="ot">=</span> <span class="st">"BUS_STOP_N"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>() <span class="sc">%&gt;%</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>od_data <span class="ot">&lt;-</span> od_data <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">DESTIN_ID =</span> grid_id) <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ORIGIN_ID, DESTIN_ID) <span class="sc">%&gt;%</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MORNING_PEAK =</span> <span class="fu">sum</span>(TRIPS))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will save a copy of the output in rds file format.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(od_data, <span class="st">"data/rds/od_data.rds"</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>od_data <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/od_data.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="compute-by-hexagon-grid-id" class="level4">
<h4 class="anchored" data-anchor-id="compute-by-hexagon-grid-id">2.3.2.3 Compute by Hexagon Grid ID</h4>
<p>After creating the joined data frame, we are interested in knowing the number of bus stops in each grid and the total number of trips. As such, we performed the following steps:</p>
<ul>
<li><p><code>mutate()</code> : Used to replace TRIPS with N/A to 0.</p></li>
<li><p><code>filter()</code> : Used to remove data with 0 trip</p></li>
<li><p><code>group_by()</code>: Used to group data based on <strong>grid_id</strong>.</p></li>
<li><p><code>summarize()</code> :</p>
<ul>
<li><p><code>n()</code> : Used to count number of bus stops and save as <em>bus_stop_count</em></p></li>
<li><p><code>sum()</code> : Used to sum the TRIPS values and save as <em>total_trips</em></p></li>
</ul></li>
<li><p><code>ungroup()</code> : Used to end a definition, often use with <code>group_by()</code></p></li>
</ul>
<div class="cell">

</div>
<p>We used <code>any(is.na())</code> to check and confirmed that there is no missing values for our data frame</p>
</section>
<section id="remove-intra-zonal-flows" class="level4">
<h4 class="anchored" data-anchor-id="remove-intra-zonal-flows">Remove Intra-zonal flows</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>od_data1 <span class="ot">&lt;-</span> od_data[od_data<span class="sc">$</span>ORIGIN_ID<span class="sc">!=</span>od_data<span class="sc">$</span>DESTIN_ID,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="create-desire-lines" class="level4">
<h4 class="anchored" data-anchor-id="create-desire-lines">Create desire lines</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>flowLine <span class="ot">&lt;-</span> <span class="fu">od2line</span>(<span class="at">flow =</span> od_data1, </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">zones =</span> hex_grid,</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">zone_code =</span> <span class="st">"grid_id"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="visualizing-desire-lines" class="level4">
<h4 class="anchored" data-anchor-id="visualizing-desire-lines">Visualizing desire lines</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(flowLine<span class="sc">$</span>MORNING_PEAK,</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.9</span>, <span class="fl">0.95</span>, <span class="fl">0.99</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    80%     90%     95%     99%    100% 
  255.0   677.0  1479.0  6219.5 89347.0 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(hex_grid) <span class="sc">+</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">col =</span> <span class="st">'grey95'</span>) <span class="sc">+</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>flowLine <span class="sc">%&gt;%</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(MORNING_PEAK <span class="sc">&gt;=</span> <span class="dv">1479</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>() <span class="sc">+</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_lines</span>(<span class="at">lwd =</span> <span class="st">"MORNING_PEAK"</span>,</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">col =</span> <span class="st">"purple"</span>,</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">style =</span> <span class="st">"quantile"</span>,</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">scale =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">10</span>),</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">n =</span> <span class="dv">6</span>,</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Commuting flow of the top 5% "</span>,</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="dv">1</span>,</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.height =</span> <span class="fl">0.35</span>, </span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width =</span> <span class="fl">0.35</span>,</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside =</span> <span class="cn">FALSE</span>,</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>),</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
</section>
<section id="data-integration" class="level2">
<h2 class="anchored" data-anchor-id="data-integration">3. Data Integration</h2>
<section id="importing-collected-data" class="level3">
<h3 class="anchored" data-anchor-id="importing-collected-data">3.1 Importing Collected Data</h3>
<p>We map it by the hexagon grid with bus stop + commuting flow + various collected data.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">Business</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Entertainment</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">F&amp;B</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">Financial Service</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-5" role="tab" aria-controls="tabset-1-5" aria-selected="false">HDB</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-6" role="tab" aria-controls="tabset-1-6" aria-selected="false">Leisure &amp; Recreation</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-7" role="tab" aria-controls="tabset-1-7" aria-selected="false">Retail</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-8" role="tab" aria-controls="tabset-1-8" aria-selected="false">School</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>business_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial"</span>,</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">layer =</span> <span class="st">"Business"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `Business' from data source 
  `/Users/smu/Rworkshop/jiawenoh/ISSS624/Take-Home_Ex/Take-Home_Ex02/data/geospatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 6550 features and 3 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 3669.148 ymin: 25408.41 xmax: 47034.83 ymax: 50148.54
Projected CRS: SVY21 / Singapore TM</code></pre>
</div>
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plotting point symbol map with analytical hexagon grid</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_options</span>(<span class="at">check.and.fix =</span> <span class="cn">TRUE</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(hex_grid) <span class="sc">+</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"bus_stops"</span>,<span class="at">palette =</span> <span class="st">"Purples"</span>) <span class="sc">+</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  flowLine <span class="sc">%&gt;%</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(MORNING_PEAK <span class="sc">&gt;=</span> <span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>() <span class="sc">+</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_lines</span>(<span class="at">lwd =</span> <span class="st">"MORNING_PEAK"</span>,</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">col =</span> <span class="st">"purple"</span>,</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">style =</span> <span class="st">"quantile"</span>,</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">scale =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">10</span>),</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">n =</span> <span class="dv">6</span>,</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Commuting flow of </span><span class="sc">\n</span><span class="st"> passengers with &gt;1,000 trips"</span>,</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="dv">1</span>,</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.height =</span> <span class="fl">0.35</span>, </span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width =</span> <span class="fl">0.35</span>,</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside =</span> <span class="cn">FALSE</span>,</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>),</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(business_sf) <span class="sc">+</span></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Business Spot"</span>,</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="dv">1</span>,</span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.height =</span> <span class="fl">0.35</span>, </span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width =</span> <span class="fl">0.35</span>,</span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside =</span> <span class="cn">FALSE</span>,</span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>),</span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">FALSE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>entertn_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial"</span>,</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">layer =</span> <span class="st">"entertn"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `entertn' from data source 
  `/Users/smu/Rworkshop/jiawenoh/ISSS624/Take-Home_Ex/Take-Home_Ex02/data/geospatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 114 features and 3 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 10809.34 ymin: 26528.63 xmax: 41600.62 ymax: 46375.77
Projected CRS: SVY21 / Singapore TM</code></pre>
</div>
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plotting point symbol map with analytical hexagon grid</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_options</span>(<span class="at">check.and.fix =</span> <span class="cn">TRUE</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(hex_grid) <span class="sc">+</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"bus_stops"</span>,<span class="at">palette =</span> <span class="st">"Purples"</span>) <span class="sc">+</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    flowLine <span class="sc">%&gt;%</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(MORNING_PEAK <span class="sc">&gt;=</span> <span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>() <span class="sc">+</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_lines</span>(<span class="at">lwd =</span> <span class="st">"MORNING_PEAK"</span>,</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">col =</span> <span class="st">"purple"</span>,</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">style =</span> <span class="st">"quantile"</span>,</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">scale =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">10</span>),</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">n =</span> <span class="dv">6</span>,</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Commuting flow of </span><span class="sc">\n</span><span class="st"> passengers with &gt;1,000 trips"</span>,</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="dv">1</span>,</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.height =</span> <span class="fl">0.35</span>, </span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width =</span> <span class="fl">0.35</span>,</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside =</span> <span class="cn">FALSE</span>,</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>),</span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(entertn_sf) <span class="sc">+</span></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Entertainment Spot"</span>,</span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="dv">1</span>,</span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.height =</span> <span class="fl">0.35</span>, </span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width =</span> <span class="fl">0.35</span>,</span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside =</span> <span class="cn">FALSE</span>,</span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>),</span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">FALSE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>fnb_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial"</span>,</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">layer =</span> <span class="st">"F&amp;B"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `F&amp;B' from data source 
  `/Users/smu/Rworkshop/jiawenoh/ISSS624/Take-Home_Ex/Take-Home_Ex02/data/geospatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 1919 features and 3 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 6010.495 ymin: 25343.27 xmax: 45462.43 ymax: 48796.21
Projected CRS: SVY21 / Singapore TM</code></pre>
</div>
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plotting point symbol map with analytical hexagon grid</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_options</span>(<span class="at">check.and.fix =</span> <span class="cn">TRUE</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(hex_grid) <span class="sc">+</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"bus_stops"</span>,<span class="at">palette =</span> <span class="st">"Purples"</span>) <span class="sc">+</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    flowLine <span class="sc">%&gt;%</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(MORNING_PEAK <span class="sc">&gt;=</span> <span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>() <span class="sc">+</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_lines</span>(<span class="at">lwd =</span> <span class="st">"MORNING_PEAK"</span>,</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">col =</span> <span class="st">"purple"</span>,</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">style =</span> <span class="st">"quantile"</span>,</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">scale =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">10</span>),</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">n =</span> <span class="dv">6</span>,</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Commuting flow of </span><span class="sc">\n</span><span class="st"> passengers with &gt;1,000 trips"</span>,</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="dv">1</span>,</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.height =</span> <span class="fl">0.35</span>, </span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width =</span> <span class="fl">0.35</span>,</span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside =</span> <span class="cn">FALSE</span>,</span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>),</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(fnb_sf) <span class="sc">+</span></span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span></span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Food and Beverages Spot"</span>,</span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="dv">1</span>,</span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.height =</span> <span class="fl">0.35</span>, </span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width =</span> <span class="fl">0.35</span>,</span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside =</span> <span class="cn">FALSE</span>,</span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>),</span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">FALSE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>finserv_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial"</span>,</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">layer =</span> <span class="st">"FinServ"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `FinServ' from data source 
  `/Users/smu/Rworkshop/jiawenoh/ISSS624/Take-Home_Ex/Take-Home_Ex02/data/geospatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 3320 features and 3 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 4881.527 ymin: 25171.88 xmax: 46526.16 ymax: 49338.02
Projected CRS: SVY21 / Singapore TM</code></pre>
</div>
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plotting point symbol map with analytical hexagon grid</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_options</span>(<span class="at">check.and.fix =</span> <span class="cn">TRUE</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(hex_grid) <span class="sc">+</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"bus_stops"</span>,<span class="at">palette =</span> <span class="st">"Purples"</span>) <span class="sc">+</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>    flowLine <span class="sc">%&gt;%</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(MORNING_PEAK <span class="sc">&gt;=</span> <span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>() <span class="sc">+</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_lines</span>(<span class="at">lwd =</span> <span class="st">"MORNING_PEAK"</span>,</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">col =</span> <span class="st">"purple"</span>,</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">style =</span> <span class="st">"quantile"</span>,</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">scale =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">10</span>),</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">n =</span> <span class="dv">6</span>,</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Commuting flow of </span><span class="sc">\n</span><span class="st"> passengers with &gt;1,000 trips"</span>,</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="dv">1</span>,</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.height =</span> <span class="fl">0.35</span>, </span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width =</span> <span class="fl">0.35</span>,</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside =</span> <span class="cn">FALSE</span>,</span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>),</span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(finserv_sf) <span class="sc">+</span></span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span></span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Financial Service Spot"</span>,</span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="dv">1</span>,</span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.height =</span> <span class="fl">0.35</span>, </span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width =</span> <span class="fl">0.35</span>,</span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside =</span> <span class="cn">FALSE</span>,</span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>),</span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">FALSE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-5-tab">
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co">#import hdb.csv and tidy data </span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>hdb <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/aspatial/hdb.csv"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">latitude =</span> <span class="st">"lat"</span>,</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">longitude =</span> <span class="st">"lng"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(postal, addr, latitude, longitude)</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="co">#converting an aspatial data into sf tibble data.frame</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>hdb_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(hdb, </span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"longitude"</span>, <span class="st">"latitude"</span>),</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>                       <span class="at">crs=</span><span class="dv">4326</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a><span class="co">#plotting point symbol map with analytical hexagon grid</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_options</span>(<span class="at">check.and.fix =</span> <span class="cn">TRUE</span>)</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(hex_grid) <span class="sc">+</span></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"bus_stops"</span>,<span class="at">palette =</span> <span class="st">"Purples"</span>) <span class="sc">+</span></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>    flowLine <span class="sc">%&gt;%</span></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(MORNING_PEAK <span class="sc">&gt;=</span> <span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>() <span class="sc">+</span></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_lines</span>(<span class="at">lwd =</span> <span class="st">"MORNING_PEAK"</span>,</span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>           <span class="at">col =</span> <span class="st">"purple"</span>,</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>           <span class="at">style =</span> <span class="st">"quantile"</span>,</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>           <span class="at">scale =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">10</span>),</span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>           <span class="at">n =</span> <span class="dv">6</span>,</span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Commuting flow of </span><span class="sc">\n</span><span class="st"> passengers with &gt;1,000 trips"</span>,</span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="dv">1</span>,</span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.height =</span> <span class="fl">0.35</span>, </span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width =</span> <span class="fl">0.35</span>,</span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside =</span> <span class="cn">FALSE</span>,</span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>),</span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(hdb_sf) <span class="sc">+</span></span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span></span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"HDB Spot"</span>,</span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb42-39"><a href="#cb42-39" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="dv">1</span>,</span>
<span id="cb42-40"><a href="#cb42-40" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.height =</span> <span class="fl">0.35</span>, </span>
<span id="cb42-41"><a href="#cb42-41" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width =</span> <span class="fl">0.35</span>,</span>
<span id="cb42-42"><a href="#cb42-42" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside =</span> <span class="cn">FALSE</span>,</span>
<span id="cb42-43"><a href="#cb42-43" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>),</span>
<span id="cb42-44"><a href="#cb42-44" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">FALSE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-6-tab">
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>lnr_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial"</span>,</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">layer =</span> <span class="st">"Liesure&amp;Recreation"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `Liesure&amp;Recreation' from data source 
  `/Users/smu/Rworkshop/jiawenoh/ISSS624/Take-Home_Ex/Take-Home_Ex02/data/geospatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 1217 features and 30 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 6010.495 ymin: 25134.28 xmax: 48439.77 ymax: 50078.88
Projected CRS: SVY21 / Singapore TM</code></pre>
</div>
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plotting point symbol map with analytical hexagon grid</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_options</span>(<span class="at">check.and.fix =</span> <span class="cn">TRUE</span>)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(hex_grid) <span class="sc">+</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"bus_stops"</span>,<span class="at">palette =</span> <span class="st">"Purples"</span>) <span class="sc">+</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>    flowLine <span class="sc">%&gt;%</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(MORNING_PEAK <span class="sc">&gt;=</span> <span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>() <span class="sc">+</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_lines</span>(<span class="at">lwd =</span> <span class="st">"MORNING_PEAK"</span>,</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">col =</span> <span class="st">"purple"</span>,</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">style =</span> <span class="st">"quantile"</span>,</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">scale =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">10</span>),</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">n =</span> <span class="dv">6</span>,</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Commuting flow of </span><span class="sc">\n</span><span class="st"> passengers with &gt;1,000 trips"</span>,</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="dv">1</span>,</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.height =</span> <span class="fl">0.35</span>, </span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width =</span> <span class="fl">0.35</span>,</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside =</span> <span class="cn">FALSE</span>,</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>),</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(lnr_sf) <span class="sc">+</span></span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span></span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Leisure and Recreation Spot"</span>,</span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="dv">1</span>,</span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.height =</span> <span class="fl">0.35</span>, </span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width =</span> <span class="fl">0.35</span>,</span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside =</span> <span class="cn">FALSE</span>,</span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>),</span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">FALSE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-7-tab">
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>retail_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial"</span>,</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">layer =</span> <span class="st">"Retails"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `Retails' from data source 
  `/Users/smu/Rworkshop/jiawenoh/ISSS624/Take-Home_Ex/Take-Home_Ex02/data/geospatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 37635 features and 3 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 4737.982 ymin: 25171.88 xmax: 48265.04 ymax: 50135.28
Projected CRS: SVY21 / Singapore TM</code></pre>
</div>
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plotting point symbol map with analytical hexagon grid</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_options</span>(<span class="at">check.and.fix =</span> <span class="cn">TRUE</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(hex_grid) <span class="sc">+</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"bus_stops"</span>,<span class="at">palette =</span> <span class="st">"Purples"</span>) <span class="sc">+</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>    flowLine <span class="sc">%&gt;%</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(MORNING_PEAK <span class="sc">&gt;=</span> <span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>() <span class="sc">+</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_lines</span>(<span class="at">lwd =</span> <span class="st">"MORNING_PEAK"</span>,</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">col =</span> <span class="st">"purple"</span>,</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">style =</span> <span class="st">"quantile"</span>,</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">scale =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">10</span>),</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">n =</span> <span class="dv">6</span>,</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Commuting flow of </span><span class="sc">\n</span><span class="st"> passengers with &gt;1,000 trips"</span>,</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="dv">1</span>,</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.height =</span> <span class="fl">0.35</span>, </span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width =</span> <span class="fl">0.35</span>,</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside =</span> <span class="cn">FALSE</span>,</span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>),</span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(retail_sf) <span class="sc">+</span></span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span></span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Retail Spot"</span>,</span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="dv">1</span>,</span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.height =</span> <span class="fl">0.35</span>, </span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width =</span> <span class="fl">0.35</span>,</span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside =</span> <span class="cn">FALSE</span>,</span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>),</span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">FALSE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-8-tab">
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co">#import school.csv into R environment </span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>schools <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/aspatial/schools.csv"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">latitude =</span> <span class="st">'results.LATITUDE'</span>, <span class="at">longitude =</span><span class="st">'results.LONGITUDE'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(postal_code, school_name, latitude, longitude)</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="co">#convert an aspatial data into sf tibble data frame</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>schools_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(schools, </span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"longitude"</span>, <span class="st">"latitude"</span>),</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">crs=</span><span class="dv">4326</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a><span class="co">#plotting point symbol map with analytical hexagon grid</span></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_options</span>(<span class="at">check.and.fix =</span> <span class="cn">TRUE</span>)</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(hex_grid) <span class="sc">+</span></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"bus_stops"</span>,<span class="at">palette =</span> <span class="st">"Purples"</span>) <span class="sc">+</span></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>    flowLine <span class="sc">%&gt;%</span></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(MORNING_PEAK <span class="sc">&gt;=</span> <span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>() <span class="sc">+</span></span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_lines</span>(<span class="at">lwd =</span> <span class="st">"MORNING_PEAK"</span>,</span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>           <span class="at">col =</span> <span class="st">"purple"</span>,</span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>           <span class="at">style =</span> <span class="st">"quantile"</span>,</span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a>           <span class="at">scale =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">10</span>),</span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a>           <span class="at">n =</span> <span class="dv">6</span>,</span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Commuting flow of </span><span class="sc">\n</span><span class="st"> passengers with &gt;1,000 trips"</span>,</span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="dv">1</span>,</span>
<span id="cb49-29"><a href="#cb49-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.height =</span> <span class="fl">0.35</span>, </span>
<span id="cb49-30"><a href="#cb49-30" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width =</span> <span class="fl">0.35</span>,</span>
<span id="cb49-31"><a href="#cb49-31" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside =</span> <span class="cn">FALSE</span>,</span>
<span id="cb49-32"><a href="#cb49-32" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>),</span>
<span id="cb49-33"><a href="#cb49-33" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb49-34"><a href="#cb49-34" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(schools_sf) <span class="sc">+</span></span>
<span id="cb49-35"><a href="#cb49-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span></span>
<span id="cb49-36"><a href="#cb49-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"School Spot"</span>,</span>
<span id="cb49-37"><a href="#cb49-37" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb49-38"><a href="#cb49-38" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="dv">1</span>,</span>
<span id="cb49-39"><a href="#cb49-39" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.height =</span> <span class="fl">0.35</span>, </span>
<span id="cb49-40"><a href="#cb49-40" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width =</span> <span class="fl">0.35</span>,</span>
<span id="cb49-41"><a href="#cb49-41" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside =</span> <span class="cn">FALSE</span>,</span>
<span id="cb49-42"><a href="#cb49-42" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>),</span>
<span id="cb49-43"><a href="#cb49-43" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">FALSE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="compute-point-in-polygon-count" class="level3">
<h3 class="anchored">3.2 Compute point-in-polygon count</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Business</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Entertainment</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">F&amp;B</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false">Financial Service</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-5" role="tab" aria-controls="tabset-2-5" aria-selected="false">HDB</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-6" role="tab" aria-controls="tabset-2-6" aria-selected="false">Leisure &amp; Recreation</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-7" role="tab" aria-controls="tabset-2-7" aria-selected="false">Retail</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-8" role="tab" aria-controls="tabset-2-8" aria-selected="false">School</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<section id="count-number-of-businesses-in-hexagon-grid" class="level2">
<h2 class="anchored" data-anchor-id="count-number-of-businesses-in-hexagon-grid">Count number of Businesses in Hexagon Grid</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>hex_grid<span class="sc">$</span><span class="st">`</span><span class="at">BUSINESS_COUNT</span><span class="st">`</span><span class="ot">&lt;-</span> <span class="fu">lengths</span>(<span class="fu">st_intersects</span>(hex_grid, business_sf))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="summary-statistics" class="level2">
<h2 class="anchored" data-anchor-id="summary-statistics">Summary Statistics</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(hex_grid<span class="sc">$</span>BUSINESS_COUNT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.000   0.000   0.000   3.368   1.000 126.000 </code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<section id="count-number-of-entertainment-in-hexagon-grid" class="level2">
<h2 class="anchored" data-anchor-id="count-number-of-entertainment-in-hexagon-grid">Count number of Entertainment in Hexagon Grid</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>hex_grid<span class="sc">$</span><span class="st">`</span><span class="at">ENTERTAINMENT_COUNT</span><span class="st">`</span><span class="ot">&lt;-</span> <span class="fu">lengths</span>(<span class="fu">st_intersects</span>(hex_grid, entertn_sf))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="summary-statistics-1" class="level2">
<h2 class="anchored" data-anchor-id="summary-statistics-1">Summary Statistics</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(hex_grid<span class="sc">$</span>ENTERTAINMENT_COUNT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
 0.00000  0.00000  0.00000  0.05861  0.00000 13.00000 </code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<section id="count-number-of-food-and-beverages-in-hexagon-grid" class="level2">
<h2 class="anchored" data-anchor-id="count-number-of-food-and-beverages-in-hexagon-grid">Count number of Food and Beverages in Hexagon Grid</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>hex_grid<span class="sc">$</span><span class="st">`</span><span class="at">fnb_COUNT</span><span class="st">`</span><span class="ot">&lt;-</span> <span class="fu">lengths</span>(<span class="fu">st_intersects</span>(hex_grid, fnb_sf))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="summary-statistics-2" class="level2">
<h2 class="anchored" data-anchor-id="summary-statistics-2">Summary Statistics</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(hex_grid<span class="sc">$</span>fnb_COUNT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
  0.0000   0.0000   0.0000   0.9866   0.0000 127.0000 </code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<section id="count-number-of-financial-services-in-hexagon-grid" class="level2">
<h2 class="anchored" data-anchor-id="count-number-of-financial-services-in-hexagon-grid">Count number of Financial Services in Hexagon Grid</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>hex_grid<span class="sc">$</span><span class="st">`</span><span class="at">finserv_COUNT</span><span class="st">`</span><span class="ot">&lt;-</span> <span class="fu">lengths</span>(<span class="fu">st_intersects</span>(hex_grid, finserv_sf))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="summary-statistics-3" class="level2">
<h2 class="anchored" data-anchor-id="summary-statistics-3">Summary Statistics</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(hex_grid<span class="sc">$</span>finserv_COUNT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.000   0.000   0.000   1.707   0.000 176.000 </code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-2-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-5-tab">
<section id="count-number-of-hdb-in-hexagon-grid" class="level2">
<h2 class="anchored" data-anchor-id="count-number-of-hdb-in-hexagon-grid">Count number of HDB in Hexagon Grid</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>hex_grid<span class="sc">$</span><span class="st">`</span><span class="at">HDB_COUNT</span><span class="st">`</span><span class="ot">&lt;-</span> <span class="fu">lengths</span>(<span class="fu">st_intersects</span>(hex_grid, hdb_sf))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="summary-statistics-4" class="level2">
<h2 class="anchored" data-anchor-id="summary-statistics-4">Summary Statistics</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(hex_grid<span class="sc">$</span>HDB_COUNT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.000   0.000   0.000   6.397   0.000  95.000 </code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-2-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-6-tab">
<section id="count-number-of-leisure-recreation-in-hexagon-grid" class="level2">
<h2 class="anchored" data-anchor-id="count-number-of-leisure-recreation-in-hexagon-grid">Count number of Leisure &amp; Recreation in Hexagon Grid</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>hex_grid<span class="sc">$</span><span class="st">`</span><span class="at">lnr_COUNT</span><span class="st">`</span><span class="ot">&lt;-</span> <span class="fu">lengths</span>(<span class="fu">st_intersects</span>(hex_grid, lnr_sf))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="summary-statistics-5" class="level2">
<h2 class="anchored" data-anchor-id="summary-statistics-5">Summary Statistics</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(hex_grid<span class="sc">$</span>lnr_COUNT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.0000  0.0000  0.0000  0.6257  0.0000 35.0000 </code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-2-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-7-tab">
<section id="count-number-of-retails-in-hexagon-grid" class="level2">
<h2 class="anchored" data-anchor-id="count-number-of-retails-in-hexagon-grid">Count number of Retails in Hexagon Grid</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>hex_grid<span class="sc">$</span><span class="st">`</span><span class="at">retail_COUNT</span><span class="st">`</span><span class="ot">&lt;-</span> <span class="fu">lengths</span>(<span class="fu">st_intersects</span>(hex_grid, retail_sf))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="summary-statistics-6" class="level2">
<h2 class="anchored" data-anchor-id="summary-statistics-6">Summary Statistics</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(hex_grid<span class="sc">$</span>retail_COUNT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.00    0.00    0.00   19.35    6.00 1427.00 </code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-2-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-8-tab">
<section id="count-number-of-school-in-hexagon-grid" class="level2">
<h2 class="anchored" data-anchor-id="count-number-of-school-in-hexagon-grid">Count number of School in Hexagon Grid</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>hex_grid<span class="sc">$</span><span class="st">`</span><span class="at">school_COUNT</span><span class="st">`</span><span class="ot">&lt;-</span> <span class="fu">lengths</span>(<span class="fu">st_intersects</span>(hex_grid, schools_sf))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="summary-statistics-7" class="level2">
<h2 class="anchored" data-anchor-id="summary-statistics-7">Summary Statistics</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(hex_grid<span class="sc">$</span>school_COUNT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.0000  0.0000  0.0000  0.1799  0.0000  5.0000 </code></pre>
</div>
</div>
</section>
</div>
</div>
</div>
<p>We append the point symbol to our existing map. Based on the commuting flow of Weekday Morning (0600-0900), we will drop off: - Entertainment - Food &amp; Beverages - Leisure &amp; Recreation</p>
<p>For future analysis, we will be focusing on Business, Entertainment, F&amp;B, and Financial Service.</p>
</section>
</section>
<section id="distance-matrix" class="level2">
<h2 class="anchored" data-anchor-id="distance-matrix">4. Distance Matrix</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>hex_grid_sp <span class="ot">&lt;-</span> <span class="fu">as</span>(hex_grid, <span class="st">"Spatial"</span>)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>hex_grid_sp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>class       : SpatialPolygonsDataFrame 
features    : 1945 
extent      : 2292.538, 57042.54, 15315.71, 50606.24  (xmin, xmax, ymin, ymax)
crs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs 
variables   : 10
names       : grid_id, bus_stops, BUSINESS_COUNT, ENTERTAINMENT_COUNT, fnb_COUNT, finserv_COUNT, HDB_COUNT, lnr_COUNT, retail_COUNT, school_COUNT 
min values  :       1,         0,              0,                   0,         0,             0,         0,         0,            0,            0 
max values  :     999,        20,            126,                  13,       127,           176,        95,        35,         1427,            5 </code></pre>
</div>
</div>
<p>Next, we compute the Euclidean distance between the centroids of the planning subzones with the use of <code>spDists()</code> of <strong>sp</strong> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>dist <span class="ot">&lt;-</span> <span class="fu">spDists</span>(hex_grid_sp, </span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">longlat =</span> <span class="cn">FALSE</span>)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dist, <span class="at">n=</span><span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]     [,8]
 [1,]    0.000 1299.038 2598.076 3897.114 5196.152  750.000 1984.313 3269.174
 [2,] 1299.038    0.000 1299.038 2598.076 3897.114  750.000  750.000 1984.313
 [3,] 2598.076 1299.038    0.000 1299.038 2598.076 1984.313  750.000  750.000
 [4,] 3897.114 2598.076 1299.038    0.000 1299.038 3269.174 1984.313  750.000
 [5,] 5196.152 3897.114 2598.076 1299.038    0.000 4562.072 3269.174 1984.313
 [6,]  750.000  750.000 1984.313 3269.174 4562.072    0.000 1299.038 2598.076
 [7,] 1984.313  750.000  750.000 1984.313 3269.174 1299.038    0.000 1299.038
 [8,] 3269.174 1984.313  750.000  750.000 1984.313 2598.076 1299.038    0.000
 [9,] 4562.072 3269.174 1984.313  750.000  750.000 3897.114 2598.076 1299.038
[10,] 5857.687 4562.072 3269.174 1984.313  750.000 5196.152 3897.114 2598.076
          [,9]    [,10]
 [1,] 4562.072 5857.687
 [2,] 3269.174 4562.072
 [3,] 1984.313 3269.174
 [4,]  750.000 1984.313
 [5,]  750.000  750.000
 [6,] 3897.114 5196.152
 [7,] 2598.076 3897.114
 [8,] 1299.038 2598.076
 [9,]    0.000 1299.038
[10,] 1299.038    0.000</code></pre>
</div>
</div>
<p>To tidy, we will create a list sorted according to the distance matrix by grid_id.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>id_names <span class="ot">&lt;-</span> hex_grid<span class="sc">$</span>grid_id</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, we will attach <code>grid_id</code> to row and column for distance matrix matching.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dist) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(id_names)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(dist) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(id_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In addition, we will pivot the distance matrix into a long table by using the row and column of grid_id.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>distPair <span class="ot">&lt;-</span> <span class="fu">melt</span>(dist) <span class="sc">%&gt;%</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">dist =</span> value)</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(distPair, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Var1 Var2     dist
1     1    1    0.000
2     2    1 1299.038
3     3    1 2598.076
4     4    1 3897.114
5     5    1 5196.152
6     6    1  750.000
7     7    1 1984.313
8     8    1 3269.174
9     9    1 4562.072
10   10    1 5857.687</code></pre>
</div>
</div>
<p>From the data frame above, we noticed that the intra-zonal distance within the zone is zero. As such, we will append a constant value to replace the intra-zonal distance of 0 by performing the following:</p>
<ul>
<li>Find out the minimum value of the distance by using <code>summary()</code></li>
<li>Input a constant distance value</li>
<li>Rename original and destination fields</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>distPair <span class="sc">%&gt;%</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(dist <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Var1           Var2           dist      
 Min.   :   1   Min.   :   1   Min.   :  750  
 1st Qu.: 487   1st Qu.: 487   1st Qu.:10894  
 Median : 973   Median : 973   Median :17477  
 Mean   : 973   Mean   : 973   Mean   :18932  
 3rd Qu.:1459   3rd Qu.:1459   3rd Qu.:25401  
 Max.   :1945   Max.   :1945   Max.   :57862  </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>distPair<span class="sc">$</span>dist <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(distPair<span class="sc">$</span>dist <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>                        <span class="dv">200</span>, distPair<span class="sc">$</span>dist)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="co"># to check the distPair data frame</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>distPair <span class="sc">%&gt;%</span></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Var1           Var2           dist      
 Min.   :   1   Min.   :   1   Min.   :  200  
 1st Qu.: 487   1st Qu.: 487   1st Qu.:10894  
 Median : 973   Median : 973   Median :17477  
 Mean   : 973   Mean   : 973   Mean   :18923  
 3rd Qu.:1459   3rd Qu.:1459   3rd Qu.:25401  
 Max.   :1945   Max.   :1945   Max.   :57862  </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co">#to rename the fields</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>distPair <span class="ot">&lt;-</span> distPair <span class="sc">%&gt;%</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">orig =</span> Var1,</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">dest =</span> Var2)</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a><span class="co">#to save output to rds </span></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(distPair, <span class="st">"data/rds/distPair.rds"</span>) </span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>distPair <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/distPair.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="prepare-flow-data" class="level3">
<h3 class="anchored" data-anchor-id="prepare-flow-data">Prepare flow data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>flow_data <span class="ot">&lt;-</span> od_data <span class="sc">%&gt;%</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ORIGIN_ID, DESTIN_ID) <span class="sc">%&gt;%</span> </span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">TRIPS =</span> <span class="fu">sum</span>(MORNING_PEAK)) </span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(flow_data, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 3
# Groups:   ORIGIN_ID [3]
   ORIGIN_ID DESTIN_ID TRIPS
   &lt;fct&gt;     &lt;fct&gt;     &lt;dbl&gt;
 1 21        49            1
 2 21        60            2
 3 21        69            2
 4 21        82            1
 5 21        86           56
 6 29        60           13
 7 29        86           37
 8 40        72            1
 9 40        87           32
10 40        100           9</code></pre>
</div>
</div>
<p>We will use <code>ifelse()</code> function to add three new fields in the dataframe with the condition that if Origin ID match Destination ID , zero will be forced.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>flow_data<span class="sc">$</span>FlowNoIntra <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>  flow_data<span class="sc">$</span>ORIGIN_ID <span class="sc">==</span> flow_data<span class="sc">$</span>DESTIN_ID, </span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>  <span class="dv">0</span>, flow_data<span class="sc">$</span>TRIPS)</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>flow_data<span class="sc">$</span>offset <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>  flow_data<span class="sc">$</span>ORIGIN_ID <span class="sc">==</span> flow_data<span class="sc">$</span>DESTIN_ID, </span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.000001</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(flow_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 65,700
Columns: 5
Groups: ORIGIN_ID [820]
$ ORIGIN_ID   &lt;fct&gt; 21, 21, 21, 21, 21, 29, 29, 40, 40, 40, 40, 41, 41, 41, 41…
$ DESTIN_ID   &lt;fct&gt; 49, 60, 69, 82, 86, 60, 86, 72, 87, 100, 253, 40, 49, 50, …
$ TRIPS       &lt;dbl&gt; 1, 2, 2, 1, 56, 13, 37, 1, 32, 9, 2, 21, 3, 5, 4, 1, 7, 36…
$ FlowNoIntra &lt;dbl&gt; 1, 2, 2, 1, 56, 13, 37, 1, 32, 9, 2, 21, 3, 5, 4, 1, 7, 36…
$ offset      &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co">#convert flow data from int to fct </span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>flow_data<span class="sc">$</span>ORIGIN_ID <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(flow_data<span class="sc">$</span>ORIGIN_ID)</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>flow_data<span class="sc">$</span>DESTIN_ID <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(flow_data<span class="sc">$</span>DESTIN_ID)</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a><span class="co">#convert distPair from int to fct </span></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>distPair<span class="sc">$</span>orig <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(distPair<span class="sc">$</span>orig)</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>distPair<span class="sc">$</span>dest <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(distPair<span class="sc">$</span>dest)</span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(distPair)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 3,783,025
Columns: 3
$ orig &lt;fct&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19…
$ dest &lt;fct&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…
$ dist &lt;dbl&gt; 200.000, 1299.038, 2598.076, 3897.114, 5196.152, 750.000, 1984.31…</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>flow_data1 <span class="ot">&lt;-</span> flow_data <span class="sc">%&gt;%</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span> (distPair,</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"ORIGIN_ID"</span> <span class="ot">=</span> <span class="st">"orig"</span>,</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"DESTIN_ID"</span> <span class="ot">=</span> <span class="st">"dest"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="preparing-origin-attributes" class="level3">
<h3 class="anchored" data-anchor-id="preparing-origin-attributes">Preparing Origin Attributes</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>business_sff <span class="ot">&lt;-</span> <span class="fu">st_intersection</span>(business_sf, hex_grid)  </span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>business_sff<span class="sc">$</span>grid_id <span class="ot">=</span> <span class="fu">as.factor</span>(business_sff<span class="sc">$</span>grid_id) </span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>business_sff <span class="ot">&lt;-</span> business_sff <span class="sc">%&gt;%</span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(POI_NAME, grid_id) <span class="sc">%&gt;%</span></span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_drop_geometry</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="count" class="level2">
<h2 class="anchored" data-anchor-id="count">COUNT</h2>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>flow_data2 <span class="ot">&lt;-</span> flow_data1 <span class="sc">%&gt;%</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(hex_grid,</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="at">ORIGIN_ID =</span> <span class="st">"grid_id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">ORIGIN_BUSINESS =</span> BUSINESS_COUNT,</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">ORIGIN_ENTERTAINMENT =</span> ENTERTAINMENT_COUNT,</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">ORIGIN_FNB =</span> fnb_COUNT,</span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">ORIGIN_FINSER =</span> finserv_COUNT,</span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">ORIGIN_HDB =</span> HDB_COUNT,</span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">ORIGIN_LEISURE =</span> lnr_COUNT,</span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">ORIGIN_RETAIL =</span> retail_COUNT,</span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">ORIGIN_SCHOOLS =</span>school_COUNT</span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">%&gt;%</span></span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(bus_stops)) </span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a>flow_data2 <span class="ot">&lt;-</span> flow_data2 <span class="sc">%&gt;%</span></span>
<span id="cb96-16"><a href="#cb96-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(hex_grid,</span>
<span id="cb96-17"><a href="#cb96-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="at">DESTIN_ID =</span> <span class="st">"grid_id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb96-18"><a href="#cb96-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">DESTIN_BUSINESS =</span> BUSINESS_COUNT,</span>
<span id="cb96-19"><a href="#cb96-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">DESTIN_ENTERTAINMENT =</span> ENTERTAINMENT_COUNT,</span>
<span id="cb96-20"><a href="#cb96-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">DESTIN_FNB =</span> fnb_COUNT,</span>
<span id="cb96-21"><a href="#cb96-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">DESTIN_FINSER =</span> finserv_COUNT,</span>
<span id="cb96-22"><a href="#cb96-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">DESTIN_HDB =</span> HDB_COUNT,</span>
<span id="cb96-23"><a href="#cb96-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">DESTIN_LEISURE =</span> lnr_COUNT,</span>
<span id="cb96-24"><a href="#cb96-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">DESTIN_RETAIL =</span> retail_COUNT,</span>
<span id="cb96-25"><a href="#cb96-25" aria-hidden="true" tabindex="-1"></a>         <span class="at">DESTIN_SCHOOLS =</span>school_COUNT</span>
<span id="cb96-26"><a href="#cb96-26" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">%&gt;%</span></span>
<span id="cb96-27"><a href="#cb96-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(bus_stops)) <span class="sc">%&gt;%</span></span>
<span id="cb96-28"><a href="#cb96-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,<span class="dv">8</span><span class="sc">:</span><span class="dv">15</span>,<span class="dv">17</span><span class="sc">:</span><span class="dv">24</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> flow_data2,</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> dist,</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> TRIPS)) <span class="sc">+</span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ggplot(data = flow_data2,</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="co">#       aes(x = log(dist),</span></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a><span class="co">#           y = log(TRIPS))) +</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  geom_point() +</span></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a><span class="co">#  geom_smooth(method = lm)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ggplot(data = SIM_data,</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="co">#       aes(x = TRIPS)) +</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  geom_histogram()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(flow_data2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   ORIGIN_ID       DESTIN_ID         TRIPS          FlowNoIntra     
 1542   :  286   1234   :  365   Min.   :    1.0   Min.   :    0.0  
 1105   :  285   1210   :  356   1st Qu.:    7.0   1st Qu.:    7.0  
 1234   :  284   1233   :  343   Median :   37.0   Median :   36.0  
 1255   :  283   1212   :  318   Mean   :  392.1   Mean   :  375.3  
 1215   :  282   1542   :  300   3rd Qu.:  182.0   3rd Qu.:  174.2  
 1218   :  281   1105   :  299   Max.   :89347.0   Max.   :89347.0  
 (Other):63999   (Other):63719                                      
     offset              dist       ORIGIN_BUSINESS   ORIGIN_ENTERTAINMENT
 Min.   :0.000001   Min.   :  200   Min.   :  0.000   Min.   : 0.0000     
 1st Qu.:1.000000   1st Qu.: 2704   1st Qu.:  0.000   1st Qu.: 0.0000     
 Median :1.000000   Median : 5250   Median :  1.000   Median : 0.0000     
 Mean   :0.990502   Mean   : 6222   Mean   :  6.582   Mean   : 0.3077     
 3rd Qu.:1.000000   3rd Qu.: 8649   3rd Qu.:  6.000   3rd Qu.: 0.0000     
 Max.   :1.000000   Max.   :25200   Max.   :126.000   Max.   :13.0000     
                                                                          
   ORIGIN_FNB      ORIGIN_FINSER       ORIGIN_HDB    ORIGIN_LEISURE 
 Min.   :  0.000   Min.   :  0.000   Min.   : 0.00   Min.   : 0.00  
 1st Qu.:  0.000   1st Qu.:  0.000   1st Qu.: 0.00   1st Qu.: 0.00  
 Median :  0.000   Median :  3.000   Median :11.00   Median : 1.00  
 Mean   :  5.155   Mean   :  8.076   Mean   :20.77   Mean   : 2.23  
 3rd Qu.:  2.000   3rd Qu.:  8.000   3rd Qu.:38.00   3rd Qu.: 3.00  
 Max.   :127.000   Max.   :176.000   Max.   :95.00   Max.   :35.00  
                                                                    
 ORIGIN_RETAIL     ORIGIN_SCHOOLS  DESTIN_BUSINESS   DESTIN_ENTERTAINMENT
 Min.   :   0.00   Min.   :0.000   Min.   :  0.000   Min.   : 0.0000     
 1st Qu.:   7.00   1st Qu.:0.000   1st Qu.:  0.000   1st Qu.: 0.0000     
 Median :  29.00   Median :0.000   Median :  1.000   Median : 0.0000     
 Mean   :  90.27   Mean   :0.586   Mean   :  7.356   Mean   : 0.3345     
 3rd Qu.:  91.00   3rd Qu.:1.000   3rd Qu.:  7.000   3rd Qu.: 0.0000     
 Max.   :1427.00   Max.   :5.000   Max.   :126.000   Max.   :13.0000     
                                                                         
   DESTIN_FNB      DESTIN_FINSER       DESTIN_HDB    DESTIN_LEISURE  
 Min.   :  0.000   Min.   :  0.000   Min.   : 0.00   Min.   : 0.000  
 1st Qu.:  0.000   1st Qu.:  0.000   1st Qu.: 0.00   1st Qu.: 0.000  
 Median :  0.000   Median :  3.000   Median : 8.00   Median : 1.000  
 Mean   :  5.822   Mean   :  8.959   Mean   :19.49   Mean   : 2.419  
 3rd Qu.:  2.000   3rd Qu.:  9.000   3rd Qu.:37.00   3rd Qu.: 3.000  
 Max.   :127.000   Max.   :176.000   Max.   :95.00   Max.   :35.000  
                                                                     
 DESTIN_RETAIL     DESTIN_SCHOOLS  
 Min.   :   0.00   Min.   :0.0000  
 1st Qu.:   7.00   1st Qu.:0.0000  
 Median :  29.00   Median :0.0000  
 Mean   :  96.66   Mean   :0.5575  
 3rd Qu.:  96.00   3rd Qu.:1.0000  
 Max.   :1427.00   Max.   :5.0000  
                                   </code></pre>
</div>
</div>
<p>The print report above reveals that that there are 17 variables that consist of 0 values, and 1 variable with 0.00001. As such, we will replace it with 0.99.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co">#FlowNoIntra</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>flow_data2<span class="sc">$</span>FlowNoIntra <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>  flow_data2<span class="sc">$</span>FlowNoIntra <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, flow_data2<span class="sc">$</span>FlowNoIntra)</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a><span class="co">#offset</span></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>flow_data2<span class="sc">$</span>offset <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>  flow_data2<span class="sc">$</span>offset <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, flow_data2<span class="sc">$</span>offset)</span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a><span class="co">#ORIGIN_BUSINESS</span></span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a>flow_data2<span class="sc">$</span>ORIGIN_BUSINESS <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a>  flow_data2<span class="sc">$</span>ORIGIN_BUSINESS <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, flow_data2<span class="sc">$</span>ORIGIN_BUSINESS)</span>
<span id="cb102-15"><a href="#cb102-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-16"><a href="#cb102-16" aria-hidden="true" tabindex="-1"></a><span class="co">#ORIGIN_ENTERTAINMENT </span></span>
<span id="cb102-17"><a href="#cb102-17" aria-hidden="true" tabindex="-1"></a>flow_data2<span class="sc">$</span>ORIGIN_ENTERTAINMENT  <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb102-18"><a href="#cb102-18" aria-hidden="true" tabindex="-1"></a>  flow_data2<span class="sc">$</span>ORIGIN_ENTERTAINMENT <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb102-19"><a href="#cb102-19" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, flow_data2<span class="sc">$</span>ORIGIN_ENTERTAINMENT)</span>
<span id="cb102-20"><a href="#cb102-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-21"><a href="#cb102-21" aria-hidden="true" tabindex="-1"></a><span class="co">#ORIGIN_FNB  </span></span>
<span id="cb102-22"><a href="#cb102-22" aria-hidden="true" tabindex="-1"></a>flow_data2<span class="sc">$</span>ORIGIN_FNB <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb102-23"><a href="#cb102-23" aria-hidden="true" tabindex="-1"></a>  flow_data2<span class="sc">$</span>ORIGIN_FNB  <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb102-24"><a href="#cb102-24" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, flow_data2<span class="sc">$</span>ORIGIN_FNB)</span>
<span id="cb102-25"><a href="#cb102-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-26"><a href="#cb102-26" aria-hidden="true" tabindex="-1"></a><span class="co">#ORIGIN_FINSER </span></span>
<span id="cb102-27"><a href="#cb102-27" aria-hidden="true" tabindex="-1"></a>flow_data2<span class="sc">$</span>ORIGIN_FINSER  <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb102-28"><a href="#cb102-28" aria-hidden="true" tabindex="-1"></a>  flow_data2<span class="sc">$</span>ORIGIN_FINSER <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb102-29"><a href="#cb102-29" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, flow_data2<span class="sc">$</span>ORIGIN_FINSER)</span>
<span id="cb102-30"><a href="#cb102-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-31"><a href="#cb102-31" aria-hidden="true" tabindex="-1"></a><span class="co">#ORIGIN_HDB</span></span>
<span id="cb102-32"><a href="#cb102-32" aria-hidden="true" tabindex="-1"></a>flow_data2<span class="sc">$</span>ORIGIN_HDB  <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb102-33"><a href="#cb102-33" aria-hidden="true" tabindex="-1"></a>  flow_data2<span class="sc">$</span>ORIGIN_HDB <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb102-34"><a href="#cb102-34" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, flow_data2<span class="sc">$</span>ORIGIN_HDB)</span>
<span id="cb102-35"><a href="#cb102-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-36"><a href="#cb102-36" aria-hidden="true" tabindex="-1"></a><span class="co">#ORIGIN_LEISURE</span></span>
<span id="cb102-37"><a href="#cb102-37" aria-hidden="true" tabindex="-1"></a>flow_data2<span class="sc">$</span>ORIGIN_LEISURE  <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb102-38"><a href="#cb102-38" aria-hidden="true" tabindex="-1"></a>  flow_data2<span class="sc">$</span>ORIGIN_LEISURE <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb102-39"><a href="#cb102-39" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, flow_data2<span class="sc">$</span>ORIGIN_LEISURE)</span>
<span id="cb102-40"><a href="#cb102-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-41"><a href="#cb102-41" aria-hidden="true" tabindex="-1"></a><span class="co">#ORIGIN_RETAIL</span></span>
<span id="cb102-42"><a href="#cb102-42" aria-hidden="true" tabindex="-1"></a>flow_data2<span class="sc">$</span>ORIGIN_RETAIL  <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb102-43"><a href="#cb102-43" aria-hidden="true" tabindex="-1"></a>  flow_data2<span class="sc">$</span>ORIGIN_RETAIL <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb102-44"><a href="#cb102-44" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, flow_data2<span class="sc">$</span>ORIGIN_RETAIL)</span>
<span id="cb102-45"><a href="#cb102-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-46"><a href="#cb102-46" aria-hidden="true" tabindex="-1"></a><span class="co">#ORIGIN_SCHOOLS</span></span>
<span id="cb102-47"><a href="#cb102-47" aria-hidden="true" tabindex="-1"></a>flow_data2<span class="sc">$</span>ORIGIN_SCHOOLS  <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb102-48"><a href="#cb102-48" aria-hidden="true" tabindex="-1"></a>  flow_data2<span class="sc">$</span>ORIGIN_SCHOOLS <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb102-49"><a href="#cb102-49" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, flow_data2<span class="sc">$</span>ORIGIN_SCHOOLS)</span>
<span id="cb102-50"><a href="#cb102-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-51"><a href="#cb102-51" aria-hidden="true" tabindex="-1"></a><span class="co">#DESTIN_BUSINESS</span></span>
<span id="cb102-52"><a href="#cb102-52" aria-hidden="true" tabindex="-1"></a>flow_data2<span class="sc">$</span>DESTIN_BUSINESS <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb102-53"><a href="#cb102-53" aria-hidden="true" tabindex="-1"></a>  flow_data2<span class="sc">$</span>DESTIN_BUSINESS <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb102-54"><a href="#cb102-54" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, flow_data2<span class="sc">$</span>DESTIN_BUSINESS)</span>
<span id="cb102-55"><a href="#cb102-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-56"><a href="#cb102-56" aria-hidden="true" tabindex="-1"></a><span class="co">#DESTIN_ENTERTAINMENT </span></span>
<span id="cb102-57"><a href="#cb102-57" aria-hidden="true" tabindex="-1"></a>flow_data2<span class="sc">$</span>DESTIN_ENTERTAINMENT  <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb102-58"><a href="#cb102-58" aria-hidden="true" tabindex="-1"></a>  flow_data2<span class="sc">$</span>DESTIN_ENTERTAINMENT <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb102-59"><a href="#cb102-59" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, flow_data2<span class="sc">$</span>DESTIN_ENTERTAINMENT)</span>
<span id="cb102-60"><a href="#cb102-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-61"><a href="#cb102-61" aria-hidden="true" tabindex="-1"></a><span class="co">#DESTIN_FNB  </span></span>
<span id="cb102-62"><a href="#cb102-62" aria-hidden="true" tabindex="-1"></a>flow_data2<span class="sc">$</span>DESTIN_FNB <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb102-63"><a href="#cb102-63" aria-hidden="true" tabindex="-1"></a>  flow_data2<span class="sc">$</span>DESTIN_FNB  <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb102-64"><a href="#cb102-64" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, flow_data2<span class="sc">$</span>DESTIN_FNB)</span>
<span id="cb102-65"><a href="#cb102-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-66"><a href="#cb102-66" aria-hidden="true" tabindex="-1"></a><span class="co">#DESTIN_FINSER </span></span>
<span id="cb102-67"><a href="#cb102-67" aria-hidden="true" tabindex="-1"></a>flow_data2<span class="sc">$</span>DESTIN_FINSER  <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb102-68"><a href="#cb102-68" aria-hidden="true" tabindex="-1"></a>  flow_data2<span class="sc">$</span>DESTIN_FINSER <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb102-69"><a href="#cb102-69" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, flow_data2<span class="sc">$</span>DESTIN_FINSER)</span>
<span id="cb102-70"><a href="#cb102-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-71"><a href="#cb102-71" aria-hidden="true" tabindex="-1"></a><span class="co">#DESTIN_HDB</span></span>
<span id="cb102-72"><a href="#cb102-72" aria-hidden="true" tabindex="-1"></a>flow_data2<span class="sc">$</span>DESTIN_HDB  <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb102-73"><a href="#cb102-73" aria-hidden="true" tabindex="-1"></a>  flow_data2<span class="sc">$</span>DESTIN_HDB <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb102-74"><a href="#cb102-74" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, flow_data2<span class="sc">$</span>DESTIN_HDB)</span>
<span id="cb102-75"><a href="#cb102-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-76"><a href="#cb102-76" aria-hidden="true" tabindex="-1"></a><span class="co">#DESTIN_LEISURE</span></span>
<span id="cb102-77"><a href="#cb102-77" aria-hidden="true" tabindex="-1"></a>flow_data2<span class="sc">$</span>DESTIN_LEISURE  <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb102-78"><a href="#cb102-78" aria-hidden="true" tabindex="-1"></a>  flow_data2<span class="sc">$</span>DESTIN_LEISURE <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb102-79"><a href="#cb102-79" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, flow_data2<span class="sc">$</span>DESTIN_LEISURE)</span>
<span id="cb102-80"><a href="#cb102-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-81"><a href="#cb102-81" aria-hidden="true" tabindex="-1"></a><span class="co">#DESTIN_RETAIL</span></span>
<span id="cb102-82"><a href="#cb102-82" aria-hidden="true" tabindex="-1"></a>flow_data2<span class="sc">$</span>DESTIN_RETAIL  <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb102-83"><a href="#cb102-83" aria-hidden="true" tabindex="-1"></a>  flow_data2<span class="sc">$</span>DESTIN_RETAIL <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb102-84"><a href="#cb102-84" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, flow_data2<span class="sc">$</span>DESTIN_RETAIL)</span>
<span id="cb102-85"><a href="#cb102-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-86"><a href="#cb102-86" aria-hidden="true" tabindex="-1"></a><span class="co">#DESTIN_SCHOOLS</span></span>
<span id="cb102-87"><a href="#cb102-87" aria-hidden="true" tabindex="-1"></a>flow_data2<span class="sc">$</span>DESTIN_SCHOOLS  <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb102-88"><a href="#cb102-88" aria-hidden="true" tabindex="-1"></a>  flow_data2<span class="sc">$</span>DESTIN_SCHOOLS <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb102-89"><a href="#cb102-89" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, flow_data2<span class="sc">$</span>DESTIN_SCHOOLS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Summary(flow_data2)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body" title="Summary(flow_data2) ">
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(flow_data2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   ORIGIN_ID       DESTIN_ID         TRIPS          FlowNoIntra      
 1542   :  286   1234   :  365   Min.   :    1.0   Min.   :    0.99  
 1105   :  285   1210   :  356   1st Qu.:    7.0   1st Qu.:    7.00  
 1234   :  284   1233   :  343   Median :   37.0   Median :   36.00  
 1255   :  283   1212   :  318   Mean   :  392.1   Mean   :  375.29  
 1215   :  282   1542   :  300   3rd Qu.:  182.0   3rd Qu.:  174.25  
 1218   :  281   1105   :  299   Max.   :89347.0   Max.   :89347.00  
 (Other):63999   (Other):63719                                       
     offset              dist       ORIGIN_BUSINESS   ORIGIN_ENTERTAINMENT
 Min.   :0.000001   Min.   :  200   Min.   :  0.990   Min.   : 0.990      
 1st Qu.:1.000000   1st Qu.: 2704   1st Qu.:  0.990   1st Qu.: 0.990      
 Median :1.000000   Median : 5250   Median :  1.000   Median : 0.990      
 Mean   :0.990502   Mean   : 6222   Mean   :  6.997   Mean   : 1.166      
 3rd Qu.:1.000000   3rd Qu.: 8649   3rd Qu.:  6.000   3rd Qu.: 0.990      
 Max.   :1.000000   Max.   :25200   Max.   :126.000   Max.   :13.000      
                                                                          
   ORIGIN_FNB      ORIGIN_FINSER       ORIGIN_HDB    ORIGIN_LEISURE  
 Min.   :  0.990   Min.   :  0.990   Min.   : 0.99   Min.   : 0.990  
 1st Qu.:  0.990   1st Qu.:  0.990   1st Qu.: 0.99   1st Qu.: 0.990  
 Median :  0.990   Median :  3.000   Median :11.00   Median : 1.000  
 Mean   :  5.714   Mean   :  8.346   Mean   :21.11   Mean   : 2.646  
 3rd Qu.:  2.000   3rd Qu.:  8.000   3rd Qu.:38.00   3rd Qu.: 3.000  
 Max.   :127.000   Max.   :176.000   Max.   :95.00   Max.   :35.000  
                                                                     
 ORIGIN_RETAIL     ORIGIN_SCHOOLS  DESTIN_BUSINESS   DESTIN_ENTERTAINMENT
 Min.   :   0.99   Min.   :0.990   Min.   :  0.990   Min.   : 0.990      
 1st Qu.:   7.00   1st Qu.:0.990   1st Qu.:  0.990   1st Qu.: 0.990      
 Median :  29.00   Median :0.990   Median :  1.000   Median : 0.990      
 Mean   :  90.34   Mean   :1.182   Mean   :  7.751   Mean   : 1.185      
 3rd Qu.:  91.00   3rd Qu.:1.000   3rd Qu.:  7.000   3rd Qu.: 0.990      
 Max.   :1427.00   Max.   :5.000   Max.   :126.000   Max.   :13.000      
                                                                         
   DESTIN_FNB      DESTIN_FINSER       DESTIN_HDB    DESTIN_LEISURE  
 Min.   :  0.990   Min.   :  0.990   Min.   : 0.99   Min.   : 0.990  
 1st Qu.:  0.990   1st Qu.:  0.990   1st Qu.: 0.99   1st Qu.: 0.990  
 Median :  0.990   Median :  3.000   Median : 8.00   Median : 1.000  
 Mean   :  6.372   Mean   :  9.229   Mean   :19.86   Mean   : 2.834  
 3rd Qu.:  2.000   3rd Qu.:  9.000   3rd Qu.:37.00   3rd Qu.: 3.000  
 Max.   :127.000   Max.   :176.000   Max.   :95.00   Max.   :35.000  
                                                                     
 DESTIN_RETAIL     DESTIN_SCHOOLS 
 Min.   :   0.99   Min.   :0.990  
 1st Qu.:   7.00   1st Qu.:0.990  
 Median :  29.00   Median :0.990  
 Mean   :  96.72   Mean   :1.173  
 3rd Qu.:  96.00   3rd Qu.:1.000  
 Max.   :1427.00   Max.   :5.000  
                                  </code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Save and Load RDS
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body" title="Save and Load RDS ">
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(flow_data2, <span class="st">"data/rds/flow_data2.rds"</span>)</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>flow_data2 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/flow_data2.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="unconstrained-spatial-interaction-model" class="level2">
<h2 class="anchored" data-anchor-id="unconstrained-spatial-interaction-model">Unconstrained Spatial Interaction Model</h2>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>uncSIM_biz <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> TRIPS <span class="sc">~</span> </span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(ORIGIN_BUSINESS) <span class="sc">+</span> </span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(DESTIN_BUSINESS) <span class="sc">+</span></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(dist),</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> flow_data2,</span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">na.action =</span> na.exclude)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(uncSIM_biz, <span class="st">"data/rds/uncSIM_biz.rds"</span>)</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>uncSIM_biz <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/uncSIM_biz.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>uncSIM_biz</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:  glm(formula = TRIPS ~ log(ORIGIN_BUSINESS) + log(DESTIN_BUSINESS) + 
    log(dist), family = poisson(link = "log"), data = flow_data2, 
    na.action = na.exclude)

Coefficients:
         (Intercept)  log(ORIGIN_BUSINESS)  log(DESTIN_BUSINESS)  
            14.26010              -0.23278               0.06139  
           log(dist)  
            -1.02191  

Degrees of Freedom: 65699 Total (i.e. Null);  65696 Residual
Null Deviance:      1.03e+08 
Residual Deviance: 71230000     AIC: 71590000</code></pre>
</div>
</div>
</section>
<section id="r-squared-function" class="level2">
<h2 class="anchored" data-anchor-id="r-squared-function">R-squared function</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co">#create function to calculate r-squared value </span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>CalcRSquared <span class="ot">&lt;-</span> <span class="cf">function</span>(observed,estimated){</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> <span class="fu">cor</span>(observed,estimated)</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>  R2 <span class="ot">&lt;-</span> r<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>  R2</span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CalcRSquared</span>(uncSIM_biz<span class="sc">$</span>data<span class="sc">$</span>TRIPS, uncSIM_biz<span class="sc">$</span>fitted.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.05312097</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co">#r2_mcfadden(uncSIM_biz)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pR2</span>(uncSIM_biz)[<span class="st">'McFadden'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>fitting null model for pseudo-r2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> McFadden 
0.3075906 </code></pre>
</div>
</div>
</section>
<section id="origin-production-constrained-sim" class="level2">
<h2 class="anchored" data-anchor-id="origin-production-constrained-sim">Origin (Production) constrained SIM</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>orcSIM_biz <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> TRIPS <span class="sc">~</span> </span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>                 ORIGIN_ID <span class="sc">+</span></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">log</span>(DESTIN_BUSINESS) <span class="sc">+</span></span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">log</span>(dist),</span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> flow_data2,</span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">na.action =</span> na.exclude)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Save and Load RDS
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body" title="Save and Load RDS ">
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(orcSIM_biz, <span class="st">"data/rds/orcSIM_biz.rds"</span>)</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>orcSIM_biz <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/orcSIM_biz.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
summary(orcSIM_biz)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body" title="Summary(orcSIM_biz)">
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(orcSIM_biz)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = TRIPS ~ ORIGIN_ID + log(DESTIN_BUSINESS) + log(dist), 
    family = poisson(link = "log"), data = flow_data2, na.action = na.exclude)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-255.55   -15.37    -8.33    -1.46   623.09  

Coefficients:
                       Estimate Std. Error   z value Pr(&gt;|z|)    
(Intercept)          10.5353897  0.1270074    82.951  &lt; 2e-16 ***
ORIGIN_ID29           0.8540829  0.1900763     4.493 7.01e-06 ***
ORIGIN_ID40           0.3013890  0.1971199     1.529 0.126274    
ORIGIN_ID41          -0.8672687  0.1682979    -5.153 2.56e-07 ***
ORIGIN_ID48           0.4511537  0.1502683     3.002 0.002679 ** 
ORIGIN_ID49           0.9379343  0.1296093     7.237 4.60e-13 ***
ORIGIN_ID50           1.6332375  0.1289948    12.661  &lt; 2e-16 ***
ORIGIN_ID51           0.3974206  0.1363306     2.915 0.003555 ** 
ORIGIN_ID59           0.8459463  0.1423419     5.943 2.80e-09 ***
ORIGIN_ID60           0.5887379  0.1309433     4.496 6.92e-06 ***
ORIGIN_ID61           0.6940363  0.1481316     4.685 2.80e-06 ***
ORIGIN_ID62           2.3796132  0.1276532    18.641  &lt; 2e-16 ***
ORIGIN_ID63          -0.2811770  0.1443047    -1.948 0.051356 .  
ORIGIN_ID69           3.1561389  0.1279933    24.659  &lt; 2e-16 ***
ORIGIN_ID70           0.3223741  0.1437147     2.243 0.024887 *  
ORIGIN_ID71          -0.1504396  0.1364659    -1.102 0.270289    
ORIGIN_ID72           2.2322100  0.1283317    17.394  &lt; 2e-16 ***
ORIGIN_ID73          -0.0757402  0.1451039    -0.522 0.601690    
ORIGIN_ID74          -0.3924619  0.1361781    -2.882 0.003952 ** 
ORIGIN_ID82           1.9302944  0.1346143    14.339  &lt; 2e-16 ***
ORIGIN_ID83          -0.0647900  0.1370666    -0.473 0.636434    
ORIGIN_ID85           0.3340796  0.1323848     2.524 0.011618 *  
ORIGIN_ID86           1.9175493  0.1279798    14.983  &lt; 2e-16 ***
ORIGIN_ID87           3.6186976  0.1271290    28.465  &lt; 2e-16 ***
ORIGIN_ID98          -0.2739099  0.1437147    -1.906 0.056660 .  
ORIGIN_ID99           0.1274048  0.1363528     0.934 0.350110    
ORIGIN_ID100          0.3705758  0.1315714     2.817 0.004854 ** 
ORIGIN_ID109          0.1118225  0.1835017     0.609 0.542272    
ORIGIN_ID111          0.3149523  0.1332684     2.363 0.018113 *  
ORIGIN_ID112          3.0618858  0.1272010    24.071  &lt; 2e-16 ***
ORIGIN_ID113         -1.0580885  0.1922559    -5.504 3.72e-08 ***
ORIGIN_ID125          3.4591714  0.1271671    27.202  &lt; 2e-16 ***
ORIGIN_ID126          0.7398682  0.1295106     5.713 1.11e-08 ***
ORIGIN_ID135          0.8566145  0.1535961     5.577 2.45e-08 ***
ORIGIN_ID136          3.2182721  0.1272183    25.297  &lt; 2e-16 ***
ORIGIN_ID137          0.8134505  0.1294932     6.282 3.35e-10 ***
ORIGIN_ID138         -1.2872309  0.2737746    -4.702 2.58e-06 ***
ORIGIN_ID148         -0.4175307  0.1534160    -2.722 0.006497 ** 
ORIGIN_ID149          1.2858427  0.1307487     9.834  &lt; 2e-16 ***
ORIGIN_ID150          0.3123995  0.1749907     1.785 0.074223 .  
ORIGIN_ID159          0.9832814  0.1307415     7.521 5.44e-14 ***
ORIGIN_ID160          2.1366676  0.1276375    16.740  &lt; 2e-16 ***
ORIGIN_ID161          0.1535223  0.1386197     1.108 0.268075    
ORIGIN_ID171         -0.1440561  0.1843535    -0.781 0.434560    
ORIGIN_ID172         -0.1726635  0.1360069    -1.270 0.204256    
ORIGIN_ID173         -0.2840087  0.1363088    -2.084 0.037199 *  
ORIGIN_ID185          0.0624614  0.1337988     0.467 0.640621    
ORIGIN_ID186          2.6355275  0.1274466    20.679  &lt; 2e-16 ***
ORIGIN_ID201          0.7895869  0.1303688     6.057 1.39e-09 ***
ORIGIN_ID202          0.1719860  0.1362212     1.263 0.206751    
ORIGIN_ID203          1.2559058  0.1313783     9.559  &lt; 2e-16 ***
ORIGIN_ID217          0.5691921  0.1382860     4.116 3.85e-05 ***
ORIGIN_ID218         -1.5752459  0.1810958    -8.698  &lt; 2e-16 ***
ORIGIN_ID219          1.2467947  0.1321454     9.435  &lt; 2e-16 ***
ORIGIN_ID220          0.3412366  0.1333289     2.559 0.010487 *  
ORIGIN_ID234          0.5683169  0.1305460     4.353 1.34e-05 ***
ORIGIN_ID235          0.6971591  0.1307204     5.333 9.65e-08 ***
ORIGIN_ID251          0.3002986  0.1339175     2.242 0.024935 *  
ORIGIN_ID252          0.5805059  0.1334744     4.349 1.37e-05 ***
ORIGIN_ID253          4.9293348  0.1270223    38.807  &lt; 2e-16 ***
ORIGIN_ID254          1.1543118  0.1377905     8.377  &lt; 2e-16 ***
ORIGIN_ID255         -0.2241055  0.2959015    -0.757 0.448831    
ORIGIN_ID268          1.7550638  0.1315451    13.342  &lt; 2e-16 ***
ORIGIN_ID269         -0.7960432  0.1411785    -5.639 1.71e-08 ***
ORIGIN_ID270          1.5673388  0.1277265    12.271  &lt; 2e-16 ***
ORIGIN_ID272          1.5364319  0.1289049    11.919  &lt; 2e-16 ***
ORIGIN_ID285          0.7711582  0.1395474     5.526 3.27e-08 ***
ORIGIN_ID286          0.5449762  0.1320781     4.126 3.69e-05 ***
ORIGIN_ID287          0.6960867  0.1291736     5.389 7.09e-08 ***
ORIGIN_ID288          0.6242891  0.1347347     4.633 3.60e-06 ***
ORIGIN_ID289          2.5697778  0.1276086    20.138  &lt; 2e-16 ***
ORIGIN_ID303          0.2183439  0.1332086     1.639 0.101190    
ORIGIN_ID304          0.4085874  0.1308743     3.122 0.001796 ** 
ORIGIN_ID306          2.8235558  0.1275930    22.129  &lt; 2e-16 ***
ORIGIN_ID307          2.1154482  0.1294212    16.345  &lt; 2e-16 ***
ORIGIN_ID320          0.4559258  0.1385097     3.292 0.000996 ***
ORIGIN_ID321          1.0814526  0.1320462     8.190 2.61e-16 ***
ORIGIN_ID322          1.5328333  0.1281393    11.962  &lt; 2e-16 ***
ORIGIN_ID323          5.1683705  0.1270430    40.682  &lt; 2e-16 ***
ORIGIN_ID324          2.7248658  0.1282454    21.247  &lt; 2e-16 ***
ORIGIN_ID325         -1.7314332  0.2877426    -6.017 1.77e-09 ***
ORIGIN_ID338          1.6469489  0.1292288    12.744  &lt; 2e-16 ***
ORIGIN_ID339          0.9883391  0.1294603     7.634 2.27e-14 ***
ORIGIN_ID340          3.4805567  0.1271256    27.379  &lt; 2e-16 ***
ORIGIN_ID341          4.7054163  0.1270481    37.036  &lt; 2e-16 ***
ORIGIN_ID342          1.2815703  0.1290516     9.931  &lt; 2e-16 ***
ORIGIN_ID343         -0.2298074  0.1402685    -1.638 0.101351    
ORIGIN_ID353         -0.5180851  0.1425825    -3.634 0.000280 ***
ORIGIN_ID354          0.9709679  0.1293182     7.508 5.99e-14 ***
ORIGIN_ID355          2.0911777  0.1274787    16.404  &lt; 2e-16 ***
ORIGIN_ID356          4.6754739  0.1270360    36.804  &lt; 2e-16 ***
ORIGIN_ID357          3.2927290  0.1273401    25.858  &lt; 2e-16 ***
ORIGIN_ID358          1.1226031  0.1329461     8.444  &lt; 2e-16 ***
ORIGIN_ID359          1.2164349  0.1294870     9.394  &lt; 2e-16 ***
ORIGIN_ID360         -0.8325576  0.2404075    -3.463 0.000534 ***
ORIGIN_ID361         -0.6550157  0.2441462    -2.683 0.007299 ** 
ORIGIN_ID370          0.3382537  0.1317592     2.567 0.010252 *  
ORIGIN_ID371          0.3049568  0.1666041     1.830 0.067186 .  
ORIGIN_ID372          4.3925892  0.1270490    34.574  &lt; 2e-16 ***
ORIGIN_ID373          5.0767094  0.1270307    39.964  &lt; 2e-16 ***
ORIGIN_ID375         -0.6447003  0.1532385    -4.207 2.59e-05 ***
ORIGIN_ID376         -1.7496291  0.1818744    -9.620  &lt; 2e-16 ***
ORIGIN_ID378         -0.3374428  0.1601653    -2.107 0.035131 *  
ORIGIN_ID379          1.6461714  0.1342631    12.261  &lt; 2e-16 ***
ORIGIN_ID386          0.4388944  0.1387359     3.164 0.001559 ** 
ORIGIN_ID387          0.3195772  0.1373528     2.327 0.019982 *  
ORIGIN_ID388          1.6492918  0.1287142    12.814  &lt; 2e-16 ***
ORIGIN_ID389          5.3845384  0.1270094    42.395  &lt; 2e-16 ***
ORIGIN_ID390          4.5413866  0.1270509    35.745  &lt; 2e-16 ***
ORIGIN_ID395         -1.9233475  1.0080323    -1.908 0.056388 .  
ORIGIN_ID396         -0.6952327  0.1803400    -3.855 0.000116 ***
ORIGIN_ID406         -1.0785595  0.1604506    -6.722 1.79e-11 ***
ORIGIN_ID407          1.4031686  0.1287426    10.899  &lt; 2e-16 ***
ORIGIN_ID408          2.3418244  0.1273062    18.395  &lt; 2e-16 ***
ORIGIN_ID409          3.9122004  0.1270766    30.786  &lt; 2e-16 ***
ORIGIN_ID411         -1.7725407  0.2404075    -7.373 1.67e-13 ***
ORIGIN_ID416         -0.3757323  0.1674330    -2.244 0.024828 *  
ORIGIN_ID417          1.4230056  0.1622752     8.769  &lt; 2e-16 ***
ORIGIN_ID424          0.3240339  0.1325906     2.444 0.014531 *  
ORIGIN_ID425          0.8212805  0.1294194     6.346 2.21e-10 ***
ORIGIN_ID426          2.9381758  0.1271491    23.108  &lt; 2e-16 ***
ORIGIN_ID427          2.7000582  0.1274537    21.185  &lt; 2e-16 ***
ORIGIN_ID434          0.0145793  0.2249709     0.065 0.948329    
ORIGIN_ID435          1.7952808  0.1400914    12.815  &lt; 2e-16 ***
ORIGIN_ID441          0.2472348  0.1346890     1.836 0.066417 .  
ORIGIN_ID442         -1.1812889  0.1796052    -6.577 4.80e-11 ***
ORIGIN_ID443          0.9111576  0.1292241     7.051 1.78e-12 ***
ORIGIN_ID444          4.7870361  0.1270314    37.684  &lt; 2e-16 ***
ORIGIN_ID446          0.1778937  0.1430318     1.244 0.213597    
ORIGIN_ID462          1.6475008  0.1281559    12.855  &lt; 2e-16 ***
ORIGIN_ID463          1.9024856  0.1278454    14.881  &lt; 2e-16 ***
ORIGIN_ID464          3.3929142  0.1271254    26.690  &lt; 2e-16 ***
ORIGIN_ID465          4.3750595  0.1270529    34.435  &lt; 2e-16 ***
ORIGIN_ID467          3.8107060  0.1271723    29.965  &lt; 2e-16 ***
ORIGIN_ID480          2.1101115  0.1278496    16.505  &lt; 2e-16 ***
ORIGIN_ID481          3.0069266  0.1271650    23.646  &lt; 2e-16 ***
ORIGIN_ID482          4.1110817  0.1270551    32.357  &lt; 2e-16 ***
ORIGIN_ID483          4.8890592  0.1270300    38.487  &lt; 2e-16 ***
ORIGIN_ID501         -0.6177487  0.1553351    -3.977 6.98e-05 ***
ORIGIN_ID502          4.1403747  0.1270513    32.588  &lt; 2e-16 ***
ORIGIN_ID503          3.4775500  0.1271595    27.348  &lt; 2e-16 ***
ORIGIN_ID504          4.6122576  0.1270363    36.307  &lt; 2e-16 ***
ORIGIN_ID506          0.7516525  0.1309050     5.742 9.36e-09 ***
ORIGIN_ID521         -0.4968236  0.1643124    -3.024 0.002497 ** 
ORIGIN_ID522          2.3437174  0.1274367    18.391  &lt; 2e-16 ***
ORIGIN_ID523          3.4110595  0.1272091    26.815  &lt; 2e-16 ***
ORIGIN_ID524          3.5263841  0.1270941    27.746  &lt; 2e-16 ***
ORIGIN_ID543          3.3553455  0.1272575    26.367  &lt; 2e-16 ***
ORIGIN_ID544          3.8292694  0.1270840    30.132  &lt; 2e-16 ***
ORIGIN_ID546          0.8822082  0.1332483     6.621 3.57e-11 ***
ORIGIN_ID558          1.9916685  0.1278017    15.584  &lt; 2e-16 ***
ORIGIN_ID559          1.3925331  0.1297090    10.736  &lt; 2e-16 ***
ORIGIN_ID560          1.1842314  0.1284756     9.218  &lt; 2e-16 ***
ORIGIN_ID561          4.1823880  0.1270447    32.921  &lt; 2e-16 ***
ORIGIN_ID569          0.0031818  0.1471525     0.022 0.982749    
ORIGIN_ID575          0.0603633  0.1342498     0.450 0.652974    
ORIGIN_ID576          3.3029531  0.1271591    25.975  &lt; 2e-16 ***
ORIGIN_ID577          0.6292736  0.1299396     4.843 1.28e-06 ***
ORIGIN_ID578          3.9313999  0.1270624    30.941  &lt; 2e-16 ***
ORIGIN_ID579          4.0573012  0.1271002    31.922  &lt; 2e-16 ***
ORIGIN_ID581          5.2263682  0.1270317    41.142  &lt; 2e-16 ***
ORIGIN_ID582          1.8692452  0.1334957    14.002  &lt; 2e-16 ***
ORIGIN_ID594          4.0984085  0.1270648    32.254  &lt; 2e-16 ***
ORIGIN_ID595          4.4876500  0.1270255    35.329  &lt; 2e-16 ***
ORIGIN_ID596          3.8116085  0.1270788    29.994  &lt; 2e-16 ***
ORIGIN_ID597          4.4216460  0.1270688    34.797  &lt; 2e-16 ***
ORIGIN_ID598          3.5452922  0.1276638    27.771  &lt; 2e-16 ***
ORIGIN_ID599          4.4064318  0.1270505    34.683  &lt; 2e-16 ***
ORIGIN_ID600          4.7097427  0.1271083    37.053  &lt; 2e-16 ***
ORIGIN_ID604         -1.9622032  0.2737746    -7.167 7.65e-13 ***
ORIGIN_ID609         -1.0530803  0.1497276    -7.033 2.02e-12 ***
ORIGIN_ID610          2.5794235  0.1272919    20.264  &lt; 2e-16 ***
ORIGIN_ID611          1.7381923  0.1275886    13.623  &lt; 2e-16 ***
ORIGIN_ID612          4.6324317  0.1270307    36.467  &lt; 2e-16 ***
ORIGIN_ID613          4.1241936  0.1270484    32.462  &lt; 2e-16 ***
ORIGIN_ID614          4.0856101  0.1270740    32.151  &lt; 2e-16 ***
ORIGIN_ID615          5.4227932  0.1270471    42.683  &lt; 2e-16 ***
ORIGIN_ID616          4.7565249  0.1270274    37.445  &lt; 2e-16 ***
ORIGIN_ID617          1.9462202  0.1302561    14.941  &lt; 2e-16 ***
ORIGIN_ID620          2.0258521  0.1278768    15.842  &lt; 2e-16 ***
ORIGIN_ID624          0.3582783  0.1323336     2.707 0.006781 ** 
ORIGIN_ID625          1.0401241  0.1308440     7.949 1.88e-15 ***
ORIGIN_ID626          3.1011237  0.1271207    24.395  &lt; 2e-16 ***
ORIGIN_ID627          2.3551839  0.1273356    18.496  &lt; 2e-16 ***
ORIGIN_ID628          4.1105161  0.1270583    32.351  &lt; 2e-16 ***
ORIGIN_ID629          3.6230432  0.1271103    28.503  &lt; 2e-16 ***
ORIGIN_ID630          3.0193016  0.1272165    23.734  &lt; 2e-16 ***
ORIGIN_ID631          4.1713709  0.1270531    32.832  &lt; 2e-16 ***
ORIGIN_ID632          4.6343387  0.1270781    36.468  &lt; 2e-16 ***
ORIGIN_ID633          4.7235969  0.1271011    37.164  &lt; 2e-16 ***
ORIGIN_ID635          0.9178475  0.1295644     7.084 1.40e-12 ***
ORIGIN_ID641          1.4046086  0.1311607    10.709  &lt; 2e-16 ***
ORIGIN_ID642          3.0375334  0.1271963    23.881  &lt; 2e-16 ***
ORIGIN_ID643          1.9153531  0.1277685    14.991  &lt; 2e-16 ***
ORIGIN_ID645          4.6112831  0.1270252    36.302  &lt; 2e-16 ***
ORIGIN_ID646          3.8880694  0.1270897    30.593  &lt; 2e-16 ***
ORIGIN_ID647          3.4675624  0.1271068    27.281  &lt; 2e-16 ***
ORIGIN_ID649          5.2100547  0.1270480    41.009  &lt; 2e-16 ***
ORIGIN_ID650          0.9833664  0.1299353     7.568 3.79e-14 ***
ORIGIN_ID651          0.6337752  0.1303189     4.863 1.15e-06 ***
ORIGIN_ID652          0.5456454  0.1324441     4.120 3.79e-05 ***
ORIGIN_ID658          0.7463361  0.1347039     5.541 3.01e-08 ***
ORIGIN_ID659          1.4914173  0.1280459    11.648  &lt; 2e-16 ***
ORIGIN_ID660          3.0861113  0.1271677    24.268  &lt; 2e-16 ***
ORIGIN_ID661          4.0805861  0.1271295    32.098  &lt; 2e-16 ***
ORIGIN_ID662          4.3627194  0.1270351    34.343  &lt; 2e-16 ***
ORIGIN_ID663          4.1399912  0.1271246    32.566  &lt; 2e-16 ***
ORIGIN_ID665          4.3245203  0.1270734    34.032  &lt; 2e-16 ***
ORIGIN_ID666          2.7074565  0.1272651    21.274  &lt; 2e-16 ***
ORIGIN_ID667          3.1135244  0.1271952    24.478  &lt; 2e-16 ***
ORIGIN_ID668          0.8765748  0.1308177     6.701 2.07e-11 ***
ORIGIN_ID669         -0.8403668  0.1492112    -5.632 1.78e-08 ***
ORIGIN_ID670          0.0123431  0.1796055     0.069 0.945210    
ORIGIN_ID676          2.4973463  0.1276331    19.567  &lt; 2e-16 ***
ORIGIN_ID677          2.6376293  0.1273555    20.711  &lt; 2e-16 ***
ORIGIN_ID678          1.5085730  0.1280138    11.784  &lt; 2e-16 ***
ORIGIN_ID679          3.1769068  0.1271888    24.978  &lt; 2e-16 ***
ORIGIN_ID680          4.0779833  0.1270587    32.095  &lt; 2e-16 ***
ORIGIN_ID682          3.9355421  0.1270647    30.973  &lt; 2e-16 ***
ORIGIN_ID683          3.9829328  0.1270654    31.346  &lt; 2e-16 ***
ORIGIN_ID684          1.3476218  0.1284192    10.494  &lt; 2e-16 ***
ORIGIN_ID685          2.1682455  0.1276554    16.985  &lt; 2e-16 ***
ORIGIN_ID686          0.1101907  0.1315139     0.838 0.402107    
ORIGIN_ID687          1.6886291  0.1289991    13.090  &lt; 2e-16 ***
ORIGIN_ID696          2.7220655  0.1274908    21.351  &lt; 2e-16 ***
ORIGIN_ID697          3.6947668  0.1270729    29.076  &lt; 2e-16 ***
ORIGIN_ID698          3.4140331  0.1271292    26.855  &lt; 2e-16 ***
ORIGIN_ID699          1.9596100  0.1276055    15.357  &lt; 2e-16 ***
ORIGIN_ID700          3.3896921  0.1270957    26.670  &lt; 2e-16 ***
ORIGIN_ID701          3.4180801  0.1271486    26.883  &lt; 2e-16 ***
ORIGIN_ID702          1.2985111  0.1281436    10.133  &lt; 2e-16 ***
ORIGIN_ID703          4.0674221  0.1270451    32.016  &lt; 2e-16 ***
ORIGIN_ID707          0.0767088  0.1447756     0.530 0.596218    
ORIGIN_ID716          1.9377959  0.1277572    15.168  &lt; 2e-16 ***
ORIGIN_ID717          4.2229875  0.1270495    33.239  &lt; 2e-16 ***
ORIGIN_ID718          5.1591592  0.1270117    40.620  &lt; 2e-16 ***
ORIGIN_ID719          2.2840898  0.1285480    17.768  &lt; 2e-16 ***
ORIGIN_ID720          2.0686813  0.1276850    16.201  &lt; 2e-16 ***
ORIGIN_ID722          2.8120020  0.1272427    22.100  &lt; 2e-16 ***
ORIGIN_ID723          4.3178078  0.1270336    33.989  &lt; 2e-16 ***
ORIGIN_ID724          3.3772779  0.1272663    26.537  &lt; 2e-16 ***
ORIGIN_ID726          0.4061530  0.1353062     3.002 0.002684 ** 
ORIGIN_ID727          4.6851594  0.1270425    36.879  &lt; 2e-16 ***
ORIGIN_ID728          3.2789765  0.1273309    25.752  &lt; 2e-16 ***
ORIGIN_ID735         -1.0877150  0.2028030    -5.363 8.17e-08 ***
ORIGIN_ID736          2.9344681  0.1271906    23.071  &lt; 2e-16 ***
ORIGIN_ID737          4.1963667  0.1270329    33.034  &lt; 2e-16 ***
ORIGIN_ID738          3.9489207  0.1271544    31.056  &lt; 2e-16 ***
ORIGIN_ID739          1.7605431  0.1289672    13.651  &lt; 2e-16 ***
ORIGIN_ID740          1.7193799  0.1276923    13.465  &lt; 2e-16 ***
ORIGIN_ID741          3.2682682  0.1271225    25.710  &lt; 2e-16 ***
ORIGIN_ID742          2.0343950  0.1274913    15.957  &lt; 2e-16 ***
ORIGIN_ID743          4.2189279  0.1270639    33.203  &lt; 2e-16 ***
ORIGIN_ID747          1.1026496  0.1304988     8.449  &lt; 2e-16 ***
ORIGIN_ID748          4.9311740  0.1270371    38.817  &lt; 2e-16 ***
ORIGIN_ID757          2.4915654  0.1272731    19.577  &lt; 2e-16 ***
ORIGIN_ID758          3.3385945  0.1271317    26.261  &lt; 2e-16 ***
ORIGIN_ID759          3.5413581  0.1270946    27.864  &lt; 2e-16 ***
ORIGIN_ID761          3.5143271  0.1270949    27.651  &lt; 2e-16 ***
ORIGIN_ID762          1.5752254  0.1280077    12.306  &lt; 2e-16 ***
ORIGIN_ID763          2.3426499  0.1274857    18.376  &lt; 2e-16 ***
ORIGIN_ID764          4.5447822  0.1270376    35.775  &lt; 2e-16 ***
ORIGIN_ID765          5.1079588  0.1270504    40.204  &lt; 2e-16 ***
ORIGIN_ID767         -0.3806879  0.2095397    -1.817 0.069251 .  
ORIGIN_ID769          3.0022194  0.1271844    23.605  &lt; 2e-16 ***
ORIGIN_ID770          5.3663283  0.1270312    42.244  &lt; 2e-16 ***
ORIGIN_ID775          2.5851376  0.1272840    20.310  &lt; 2e-16 ***
ORIGIN_ID776          1.2317795  0.1292994     9.527  &lt; 2e-16 ***
ORIGIN_ID777          2.1695541  0.1274762    17.019  &lt; 2e-16 ***
ORIGIN_ID778          2.8326073  0.1271932    22.270  &lt; 2e-16 ***
ORIGIN_ID780          2.8155539  0.1272357    22.129  &lt; 2e-16 ***
ORIGIN_ID782          3.6448838  0.1271928    28.656  &lt; 2e-16 ***
ORIGIN_ID783          3.7265657  0.1271890    29.299  &lt; 2e-16 ***
ORIGIN_ID787          4.2556946  0.1270518    33.496  &lt; 2e-16 ***
ORIGIN_ID788          4.4791148  0.1270490    35.255  &lt; 2e-16 ***
ORIGIN_ID795         -0.9464107  0.2224016    -4.255 2.09e-05 ***
ORIGIN_ID796          1.3614756  0.1288927    10.563  &lt; 2e-16 ***
ORIGIN_ID797          2.5723711  0.1275270    20.171  &lt; 2e-16 ***
ORIGIN_ID798          2.1977876  0.1274133    17.249  &lt; 2e-16 ***
ORIGIN_ID799          3.7414767  0.1270656    29.445  &lt; 2e-16 ***
ORIGIN_ID801          0.7963718  0.1308329     6.087 1.15e-09 ***
ORIGIN_ID802          5.8454720  0.1270892    45.995  &lt; 2e-16 ***
ORIGIN_ID805          2.0264620  0.1281477    15.813  &lt; 2e-16 ***
ORIGIN_ID807          3.7804028  0.1270859    29.747  &lt; 2e-16 ***
ORIGIN_ID808          3.8071138  0.1271281    29.947  &lt; 2e-16 ***
ORIGIN_ID813          1.5646098  0.1277864    12.244  &lt; 2e-16 ***
ORIGIN_ID814          0.5999079  0.1296869     4.626 3.73e-06 ***
ORIGIN_ID815          3.5923013  0.1271096    28.261  &lt; 2e-16 ***
ORIGIN_ID816          2.1821704  0.1275410    17.110  &lt; 2e-16 ***
ORIGIN_ID817          3.4579750  0.1270875    27.209  &lt; 2e-16 ***
ORIGIN_ID825          3.6563842  0.1272108    28.743  &lt; 2e-16 ***
ORIGIN_ID826          4.2989016  0.1270742    33.830  &lt; 2e-16 ***
ORIGIN_ID827         -0.1368260  0.1363752    -1.003 0.315714    
ORIGIN_ID831          3.9234740  0.1270720    30.876  &lt; 2e-16 ***
ORIGIN_ID832          3.2923541  0.1271232    25.899  &lt; 2e-16 ***
ORIGIN_ID833          4.0416964  0.1270551    31.811  &lt; 2e-16 ***
ORIGIN_ID834          2.0459939  0.1274744    16.050  &lt; 2e-16 ***
ORIGIN_ID842         -1.2021785  0.1880422    -6.393 1.63e-10 ***
ORIGIN_ID844          3.9342049  0.1270685    30.961  &lt; 2e-16 ***
ORIGIN_ID845          4.2471226  0.1271531    33.402  &lt; 2e-16 ***
ORIGIN_ID850          1.8511823  0.1277297    14.493  &lt; 2e-16 ***
ORIGIN_ID851          0.0147007  0.1359283     0.108 0.913877    
ORIGIN_ID852          2.5262457  0.1272475    19.853  &lt; 2e-16 ***
ORIGIN_ID853          3.5215102  0.1271084    27.705  &lt; 2e-16 ***
ORIGIN_ID854          1.0211496  0.1293843     7.892 2.96e-15 ***
ORIGIN_ID855          2.8793309  0.1271789    22.640  &lt; 2e-16 ***
ORIGIN_ID861          0.4078058  0.1417097     2.878 0.004005 ** 
ORIGIN_ID863          3.6619601  0.1272039    28.788  &lt; 2e-16 ***
ORIGIN_ID864          5.4829415  0.1270121    43.169  &lt; 2e-16 ***
ORIGIN_ID865          3.3082274  0.1273977    25.968  &lt; 2e-16 ***
ORIGIN_ID869          0.8146723  0.1350343     6.033 1.61e-09 ***
ORIGIN_ID870          0.6577031  0.1320923     4.979 6.39e-07 ***
ORIGIN_ID871          4.0688811  0.1270408    32.028  &lt; 2e-16 ***
ORIGIN_ID872          1.4125664  0.1278933    11.045  &lt; 2e-16 ***
ORIGIN_ID873          0.3166388  0.1367713     2.315 0.020608 *  
ORIGIN_ID880         -1.1855061  0.1598847    -7.415 1.22e-13 ***
ORIGIN_ID882          4.7113059  0.1270550    37.081  &lt; 2e-16 ***
ORIGIN_ID883          3.7817728  0.1271429    29.744  &lt; 2e-16 ***
ORIGIN_ID887          2.7089265  0.1272545    21.287  &lt; 2e-16 ***
ORIGIN_ID888          1.0374298  0.1286186     8.066 7.27e-16 ***
ORIGIN_ID889          1.0171761  0.1289382     7.889 3.05e-15 ***
ORIGIN_ID890          3.0719558  0.1271127    24.167  &lt; 2e-16 ***
ORIGIN_ID891          1.7614927  0.1277583    13.788  &lt; 2e-16 ***
ORIGIN_ID892          1.6529173  0.1276602    12.948  &lt; 2e-16 ***
ORIGIN_ID899          1.1163810  0.1404041     7.951 1.85e-15 ***
ORIGIN_ID900          4.0016674  0.1271960    31.461  &lt; 2e-16 ***
ORIGIN_ID901          5.1173967  0.1270297    40.285  &lt; 2e-16 ***
ORIGIN_ID902          2.9756748  0.1273507    23.366  &lt; 2e-16 ***
ORIGIN_ID905          1.7923375  0.1298338    13.805  &lt; 2e-16 ***
ORIGIN_ID907          1.8383827  0.1274456    14.425  &lt; 2e-16 ***
ORIGIN_ID908          4.1371401  0.1270409    32.565  &lt; 2e-16 ***
ORIGIN_ID910          2.9884247  0.1271475    23.504  &lt; 2e-16 ***
ORIGIN_ID917          0.6373030  0.1636075     3.895 9.81e-05 ***
ORIGIN_ID919          5.1373146  0.1270377    40.439  &lt; 2e-16 ***
ORIGIN_ID920          4.7216836  0.1270448    37.166  &lt; 2e-16 ***
ORIGIN_ID921          1.1881345  0.1301742     9.127  &lt; 2e-16 ***
ORIGIN_ID925          2.2327263  0.1272958    17.540  &lt; 2e-16 ***
ORIGIN_ID926          3.3815467  0.1270784    26.610  &lt; 2e-16 ***
ORIGIN_ID927          2.9532434  0.1271236    23.231  &lt; 2e-16 ***
ORIGIN_ID928          2.0641265  0.1273269    16.211  &lt; 2e-16 ***
ORIGIN_ID937          0.7310632  0.1355591     5.393 6.93e-08 ***
ORIGIN_ID938          3.4912638  0.1273562    27.413  &lt; 2e-16 ***
ORIGIN_ID939          5.0107295  0.1270317    39.445  &lt; 2e-16 ***
ORIGIN_ID940          3.5158970  0.1271531    27.651  &lt; 2e-16 ***
ORIGIN_ID941          0.9518232  0.1294696     7.352 1.96e-13 ***
ORIGIN_ID944          1.4533481  0.1278104    11.371  &lt; 2e-16 ***
ORIGIN_ID945          2.4248767  0.1272402    19.057  &lt; 2e-16 ***
ORIGIN_ID946          3.6416733  0.1270796    28.657  &lt; 2e-16 ***
ORIGIN_ID947          2.4097079  0.1273307    18.925  &lt; 2e-16 ***
ORIGIN_ID948          3.4047260  0.1271004    26.788  &lt; 2e-16 ***
ORIGIN_ID949          1.4090366  0.1277945    11.026  &lt; 2e-16 ***
ORIGIN_ID956          0.0540483  0.1639566     0.330 0.741664    
ORIGIN_ID958          3.9983077  0.1271439    31.447  &lt; 2e-16 ***
ORIGIN_ID959          4.5453443  0.1270517    35.776  &lt; 2e-16 ***
ORIGIN_ID960          2.2789985  0.1275282    17.871  &lt; 2e-16 ***
ORIGIN_ID961         -2.4099399  0.4648969    -5.184 2.17e-07 ***
ORIGIN_ID964          4.0351288  0.1271025    31.747  &lt; 2e-16 ***
ORIGIN_ID965          3.5128864  0.1270734    27.645  &lt; 2e-16 ***
ORIGIN_ID966          2.5711196  0.1275834    20.152  &lt; 2e-16 ***
ORIGIN_ID967          1.9061943  0.1275213    14.948  &lt; 2e-16 ***
ORIGIN_ID968          3.0989927  0.1271272    24.377  &lt; 2e-16 ***
ORIGIN_ID975         -1.2329775  0.2276915    -5.415 6.12e-08 ***
ORIGIN_ID976          0.4805985  0.1566284     3.068 0.002152 ** 
ORIGIN_ID978          3.8395498  0.1273010    30.161  &lt; 2e-16 ***
ORIGIN_ID979          2.6869355  0.1277319    21.036  &lt; 2e-16 ***
ORIGIN_ID980          2.2334848  0.1275980    17.504  &lt; 2e-16 ***
ORIGIN_ID982          3.8166280  0.1270598    30.038  &lt; 2e-16 ***
ORIGIN_ID983          2.9298963  0.1271695    23.039  &lt; 2e-16 ***
ORIGIN_ID984          3.4740858  0.1270838    27.337  &lt; 2e-16 ***
ORIGIN_ID985          0.8211822  0.1286674     6.382 1.75e-10 ***
ORIGIN_ID986          0.8544144  0.1283511     6.657 2.80e-11 ***
ORIGIN_ID987          0.6387963  0.1356152     4.710 2.47e-06 ***
ORIGIN_ID993         -1.4351561  0.2571557    -5.581 2.39e-08 ***
ORIGIN_ID997          3.6418523  0.1271318    28.646  &lt; 2e-16 ***
ORIGIN_ID998          0.1537531  0.1399615     1.099 0.271969    
ORIGIN_ID999          1.3021305  0.1313300     9.915  &lt; 2e-16 ***
ORIGIN_ID1002         2.9573005  0.1272006    23.249  &lt; 2e-16 ***
ORIGIN_ID1003         3.9872141  0.1270408    31.385  &lt; 2e-16 ***
ORIGIN_ID1004         1.6258893  0.1283278    12.670  &lt; 2e-16 ***
ORIGIN_ID1006         2.7329935  0.1271600    21.493  &lt; 2e-16 ***
ORIGIN_ID1013         1.2009645  0.1352021     8.883  &lt; 2e-16 ***
ORIGIN_ID1016         1.6179059  0.1304680    12.401  &lt; 2e-16 ***
ORIGIN_ID1017         4.8263057  0.1270567    37.985  &lt; 2e-16 ***
ORIGIN_ID1018         1.8965696  0.1276958    14.852  &lt; 2e-16 ***
ORIGIN_ID1021         2.2458548  0.1272817    17.645  &lt; 2e-16 ***
ORIGIN_ID1022         3.3651216  0.1270732    26.482  &lt; 2e-16 ***
ORIGIN_ID1023         2.2058322  0.1273508    17.321  &lt; 2e-16 ***
ORIGIN_ID1024         2.3712485  0.1273106    18.626  &lt; 2e-16 ***
ORIGIN_ID1026         0.9114350  0.1314177     6.935 4.05e-12 ***
ORIGIN_ID1027        -0.7164055  0.1861385    -3.849 0.000119 ***
ORIGIN_ID1031        -1.8335968  0.2176672    -8.424  &lt; 2e-16 ***
ORIGIN_ID1032         3.6502192  0.1271244    28.714  &lt; 2e-16 ***
ORIGIN_ID1036         4.7200335  0.1270351    37.155  &lt; 2e-16 ***
ORIGIN_ID1037         3.3830828  0.1271486    26.607  &lt; 2e-16 ***
ORIGIN_ID1040         3.9994244  0.1270552    31.478  &lt; 2e-16 ***
ORIGIN_ID1041         4.1576942  0.1270530    32.724  &lt; 2e-16 ***
ORIGIN_ID1042         3.8024068  0.1270569    29.927  &lt; 2e-16 ***
ORIGIN_ID1043         0.4739434  0.1308103     3.623 0.000291 ***
ORIGIN_ID1045         1.4286718  0.1279365    11.167  &lt; 2e-16 ***
ORIGIN_ID1046        -0.1286787  0.1356342    -0.949 0.342764    
ORIGIN_ID1051        -1.1328376  0.1775209    -6.381 1.75e-10 ***
ORIGIN_ID1052         2.5104933  0.1274616    19.696  &lt; 2e-16 ***
ORIGIN_ID1053         0.6655808  0.1314985     5.062 4.16e-07 ***
ORIGIN_ID1055         2.5908195  0.1278793    20.260  &lt; 2e-16 ***
ORIGIN_ID1056         4.3740564  0.1270569    34.426  &lt; 2e-16 ***
ORIGIN_ID1060         3.4234987  0.1270958    26.936  &lt; 2e-16 ***
ORIGIN_ID1061         4.1544129  0.1270359    32.703  &lt; 2e-16 ***
ORIGIN_ID1062         3.0224651  0.1271360    23.773  &lt; 2e-16 ***
ORIGIN_ID1063         2.0334317  0.1273733    15.964  &lt; 2e-16 ***
ORIGIN_ID1064         2.6589279  0.1272936    20.888  &lt; 2e-16 ***
ORIGIN_ID1066        -1.6609943  0.2012940    -8.252  &lt; 2e-16 ***
ORIGIN_ID1068         0.8872923  0.1317944     6.732 1.67e-11 ***
ORIGIN_ID1070        -0.3220438  0.1411273    -2.282 0.022493 *  
ORIGIN_ID1072        -1.2880853  0.1727070    -7.458 8.77e-14 ***
ORIGIN_ID1073         2.3190077  0.1274800    18.191  &lt; 2e-16 ***
ORIGIN_ID1074         3.4673176  0.1271357    27.273  &lt; 2e-16 ***
ORIGIN_ID1075         3.6648663  0.1271024    28.834  &lt; 2e-16 ***
ORIGIN_ID1076         1.1755101  0.1308855     8.981  &lt; 2e-16 ***
ORIGIN_ID1081         3.5643263  0.1270755    28.049  &lt; 2e-16 ***
ORIGIN_ID1082         4.3367025  0.1270312    34.139  &lt; 2e-16 ***
ORIGIN_ID1083         2.2615724  0.1273131    17.764  &lt; 2e-16 ***
ORIGIN_ID1084         2.2028391  0.1275301    17.273  &lt; 2e-16 ***
ORIGIN_ID1085         3.1197136  0.1271167    24.542  &lt; 2e-16 ***
ORIGIN_ID1088         3.0564041  0.1271705    24.034  &lt; 2e-16 ***
ORIGIN_ID1089         2.5968041  0.1273137    20.397  &lt; 2e-16 ***
ORIGIN_ID1090         2.1980902  0.1274481    17.247  &lt; 2e-16 ***
ORIGIN_ID1092         1.5666281  0.1282141    12.219  &lt; 2e-16 ***
ORIGIN_ID1094         4.4691633  0.1270400    35.179  &lt; 2e-16 ***
ORIGIN_ID1095         3.2735822  0.1271689    25.742  &lt; 2e-16 ***
ORIGIN_ID1096         3.7790634  0.1271157    29.729  &lt; 2e-16 ***
ORIGIN_ID1102        -0.4826004  0.1363974    -3.538 0.000403 ***
ORIGIN_ID1103         3.3395383  0.1273137    26.231  &lt; 2e-16 ***
ORIGIN_ID1104         2.9838595  0.1271218    23.472  &lt; 2e-16 ***
ORIGIN_ID1105         3.5254424  0.1270544    27.748  &lt; 2e-16 ***
ORIGIN_ID1106         2.7022986  0.1273307    21.223  &lt; 2e-16 ***
ORIGIN_ID1108        -0.2063293  0.1354668    -1.523 0.127734    
ORIGIN_ID1109         2.7011051  0.1272263    21.231  &lt; 2e-16 ***
ORIGIN_ID1110         2.4429553  0.1273444    19.184  &lt; 2e-16 ***
ORIGIN_ID1111         2.0928760  0.1274768    16.418  &lt; 2e-16 ***
ORIGIN_ID1112         1.0111084  0.1406843     7.187 6.62e-13 ***
ORIGIN_ID1113        -0.6312235  0.1716462    -3.677 0.000236 ***
ORIGIN_ID1114         2.6989696  0.1272487    21.210  &lt; 2e-16 ***
ORIGIN_ID1115         3.6786388  0.1271202    28.938  &lt; 2e-16 ***
ORIGIN_ID1116         4.0759869  0.1270696    32.077  &lt; 2e-16 ***
ORIGIN_ID1117         4.8777167  0.1270620    38.388  &lt; 2e-16 ***
ORIGIN_ID1118         0.8714214  0.1333797     6.533 6.43e-11 ***
ORIGIN_ID1125         3.1373997  0.1271060    24.683  &lt; 2e-16 ***
ORIGIN_ID1126         3.2760218  0.1270851    25.778  &lt; 2e-16 ***
ORIGIN_ID1127         0.9744784  0.1284289     7.588 3.26e-14 ***
ORIGIN_ID1128         2.9480007  0.1271642    23.183  &lt; 2e-16 ***
ORIGIN_ID1129         1.7825937  0.1276260    13.967  &lt; 2e-16 ***
ORIGIN_ID1130         1.3086867  0.1279011    10.232  &lt; 2e-16 ***
ORIGIN_ID1133         3.6247922  0.1270895    28.522  &lt; 2e-16 ***
ORIGIN_ID1134         3.1362984  0.1271615    24.664  &lt; 2e-16 ***
ORIGIN_ID1135         2.2390821  0.1277768    17.523  &lt; 2e-16 ***
ORIGIN_ID1137         4.7538709  0.1270248    37.425  &lt; 2e-16 ***
ORIGIN_ID1138         4.7384025  0.1270232    37.303  &lt; 2e-16 ***
ORIGIN_ID1139         3.2612851  0.1271792    25.643  &lt; 2e-16 ***
ORIGIN_ID1140         1.0669364  0.1387592     7.689 1.48e-14 ***
ORIGIN_ID1141         1.7641618  0.1333595    13.229  &lt; 2e-16 ***
ORIGIN_ID1146         1.7446681  0.1277812    13.654  &lt; 2e-16 ***
ORIGIN_ID1147         3.3380924  0.1270768    26.268  &lt; 2e-16 ***
ORIGIN_ID1148         2.8129635  0.1272125    22.112  &lt; 2e-16 ***
ORIGIN_ID1149         2.3329133  0.1278270    18.251  &lt; 2e-16 ***
ORIGIN_ID1150         2.7928784  0.1272046    21.956  &lt; 2e-16 ***
ORIGIN_ID1151         2.2484207  0.1272524    17.669  &lt; 2e-16 ***
ORIGIN_ID1152         2.5091476  0.1272091    19.725  &lt; 2e-16 ***
ORIGIN_ID1153         3.2537434  0.1271060    25.599  &lt; 2e-16 ***
ORIGIN_ID1154         3.0701720  0.1272381    24.129  &lt; 2e-16 ***
ORIGIN_ID1155         4.3095014  0.1270591    33.917  &lt; 2e-16 ***
ORIGIN_ID1156         2.7611774  0.1272720    21.695  &lt; 2e-16 ***
ORIGIN_ID1158         2.4354534  0.1279240    19.038  &lt; 2e-16 ***
ORIGIN_ID1159         3.3781280  0.1271520    26.568  &lt; 2e-16 ***
ORIGIN_ID1160         4.6045745  0.1270457    36.243  &lt; 2e-16 ***
ORIGIN_ID1162         2.8612925  0.1279445    22.364  &lt; 2e-16 ***
ORIGIN_ID1167         3.1208021  0.1271157    24.551  &lt; 2e-16 ***
ORIGIN_ID1168         2.8436952  0.1271476    22.365  &lt; 2e-16 ***
ORIGIN_ID1169         2.4876204  0.1271658    19.562  &lt; 2e-16 ***
ORIGIN_ID1170         2.5284299  0.1272147    19.875  &lt; 2e-16 ***
ORIGIN_ID1171         3.0023957  0.1271420    23.615  &lt; 2e-16 ***
ORIGIN_ID1172         3.2322952  0.1272483    25.401  &lt; 2e-16 ***
ORIGIN_ID1173         1.3884439  0.1276249    10.879  &lt; 2e-16 ***
ORIGIN_ID1174         3.6041572  0.1270826    28.361  &lt; 2e-16 ***
ORIGIN_ID1175         3.9750428  0.1270725    31.282  &lt; 2e-16 ***
ORIGIN_ID1176         3.4550963  0.1271109    27.182  &lt; 2e-16 ***
ORIGIN_ID1177         0.4630641  0.1333489     3.473 0.000515 ***
ORIGIN_ID1179         4.8450995  0.1270383    38.139  &lt; 2e-16 ***
ORIGIN_ID1180         4.0292568  0.1270936    31.703  &lt; 2e-16 ***
ORIGIN_ID1181         3.1862296  0.1273444    25.021  &lt; 2e-16 ***
ORIGIN_ID1188         2.2422737  0.1277648    17.550  &lt; 2e-16 ***
ORIGIN_ID1189         3.3792767  0.1270841    26.591  &lt; 2e-16 ***
ORIGIN_ID1190         2.2095349  0.1273185    17.354  &lt; 2e-16 ***
ORIGIN_ID1192         3.4547917  0.1270877    27.184  &lt; 2e-16 ***
ORIGIN_ID1193         3.8562881  0.1270435    30.354  &lt; 2e-16 ***
ORIGIN_ID1194         4.1073305  0.1270829    32.320  &lt; 2e-16 ***
ORIGIN_ID1195         3.6412852  0.1270701    28.656  &lt; 2e-16 ***
ORIGIN_ID1196         4.0611873  0.1270504    31.965  &lt; 2e-16 ***
ORIGIN_ID1197         3.0381430  0.1271258    23.899  &lt; 2e-16 ***
ORIGIN_ID1198         2.4345036  0.1272963    19.125  &lt; 2e-16 ***
ORIGIN_ID1201         5.0339168  0.1270337    39.627  &lt; 2e-16 ***
ORIGIN_ID1202         4.6763371  0.1270619    36.804  &lt; 2e-16 ***
ORIGIN_ID1210         2.2873543  0.1272481    17.976  &lt; 2e-16 ***
ORIGIN_ID1211         2.7372107  0.1271330    21.530  &lt; 2e-16 ***
ORIGIN_ID1212         3.5610845  0.1270524    28.028  &lt; 2e-16 ***
ORIGIN_ID1213         2.4001561  0.1272713    18.859  &lt; 2e-16 ***
ORIGIN_ID1214         3.4408389  0.1271205    27.068  &lt; 2e-16 ***
ORIGIN_ID1215         4.5896036  0.1270181    36.133  &lt; 2e-16 ***
ORIGIN_ID1216         2.9359605  0.1271188    23.096  &lt; 2e-16 ***
ORIGIN_ID1217         3.9058593  0.1270504    30.743  &lt; 2e-16 ***
ORIGIN_ID1218         4.9105781  0.1270144    38.662  &lt; 2e-16 ***
ORIGIN_ID1219         4.6445838  0.1270301    36.563  &lt; 2e-16 ***
ORIGIN_ID1220         1.7730909  0.1278126    13.873  &lt; 2e-16 ***
ORIGIN_ID1222         3.4983251  0.1272569    27.490  &lt; 2e-16 ***
ORIGIN_ID1223         5.1073611  0.1270399    40.203  &lt; 2e-16 ***
ORIGIN_ID1233         2.1086971  0.1272891    16.566  &lt; 2e-16 ***
ORIGIN_ID1234         2.8961059  0.1271009    22.786  &lt; 2e-16 ***
ORIGIN_ID1235         3.7650499  0.1270483    29.635  &lt; 2e-16 ***
ORIGIN_ID1236         2.9950126  0.1271574    23.554  &lt; 2e-16 ***
ORIGIN_ID1237         3.1778015  0.1270914    25.004  &lt; 2e-16 ***
ORIGIN_ID1238         3.5799015  0.1270622    28.174  &lt; 2e-16 ***
ORIGIN_ID1239         3.3816479  0.1270958    26.607  &lt; 2e-16 ***
ORIGIN_ID1240         3.8905289  0.1270603    30.620  &lt; 2e-16 ***
ORIGIN_ID1241         3.7140418  0.1270906    29.224  &lt; 2e-16 ***
ORIGIN_ID1245         3.3608444  0.1271936    26.423  &lt; 2e-16 ***
ORIGIN_ID1253        -0.5841901  0.1625986    -3.593 0.000327 ***
ORIGIN_ID1254         1.1312674  0.1278862     8.846  &lt; 2e-16 ***
ORIGIN_ID1255         3.2299869  0.1270720    25.419  &lt; 2e-16 ***
ORIGIN_ID1256         3.9094558  0.1270841    30.763  &lt; 2e-16 ***
ORIGIN_ID1257         4.1954924  0.1270425    33.024  &lt; 2e-16 ***
ORIGIN_ID1258         5.0190284  0.1270379    39.508  &lt; 2e-16 ***
ORIGIN_ID1259         3.7705419  0.1270646    29.674  &lt; 2e-16 ***
ORIGIN_ID1260         2.1867435  0.1273115    17.176  &lt; 2e-16 ***
ORIGIN_ID1261         4.3699977  0.1270373    34.399  &lt; 2e-16 ***
ORIGIN_ID1263         2.6393515  0.1273468    20.726  &lt; 2e-16 ***
ORIGIN_ID1266         3.4568120  0.1272117    27.174  &lt; 2e-16 ***
ORIGIN_ID1272         0.8895298  0.1288132     6.906 5.00e-12 ***
ORIGIN_ID1273         1.7064626  0.1274969    13.384  &lt; 2e-16 ***
ORIGIN_ID1274         2.9332603  0.1271046    23.078  &lt; 2e-16 ***
ORIGIN_ID1275         3.1838856  0.1271013    25.050  &lt; 2e-16 ***
ORIGIN_ID1276         3.8037756  0.1270447    29.940  &lt; 2e-16 ***
ORIGIN_ID1277         3.5550948  0.1270786    27.976  &lt; 2e-16 ***
ORIGIN_ID1278         2.0091847  0.1274553    15.764  &lt; 2e-16 ***
ORIGIN_ID1279         4.5776377  0.1270510    36.030  &lt; 2e-16 ***
ORIGIN_ID1280         3.1957247  0.1271777    25.128  &lt; 2e-16 ***
ORIGIN_ID1281         2.0665959  0.1288881    16.034  &lt; 2e-16 ***
ORIGIN_ID1283        -1.7600997  0.2077404    -8.473  &lt; 2e-16 ***
ORIGIN_ID1289         0.2546402  0.1535959     1.658 0.097346 .  
ORIGIN_ID1290        -3.6539498  1.0080323    -3.625 0.000289 ***
ORIGIN_ID1291         0.7954074  0.1293429     6.150 7.77e-10 ***
ORIGIN_ID1292         2.3241952  0.1272832    18.260  &lt; 2e-16 ***
ORIGIN_ID1293         3.3632134  0.1270774    26.466  &lt; 2e-16 ***
ORIGIN_ID1294         3.8417052  0.1270544    30.237  &lt; 2e-16 ***
ORIGIN_ID1295         4.5741896  0.1270828    35.994  &lt; 2e-16 ***
ORIGIN_ID1296         1.4349762  0.1277986    11.228  &lt; 2e-16 ***
ORIGIN_ID1297         1.5197091  0.1293977    11.744  &lt; 2e-16 ***
ORIGIN_ID1298         2.6666042  0.1272470    20.956  &lt; 2e-16 ***
ORIGIN_ID1300         1.0344975  0.1307238     7.914 2.50e-15 ***
ORIGIN_ID1301         0.1401209  0.1414924     0.990 0.322024    
ORIGIN_ID1302        -0.2781072  0.1365344    -2.037 0.041660 *  
ORIGIN_ID1307         0.1790806  0.1401354     1.278 0.201281    
ORIGIN_ID1308        -3.0830413  1.0080323    -3.058 0.002225 ** 
ORIGIN_ID1310         3.2786157  0.1270803    25.800  &lt; 2e-16 ***
ORIGIN_ID1311         2.9572710  0.1271304    23.262  &lt; 2e-16 ***
ORIGIN_ID1312         3.0489411  0.1271201    23.985  &lt; 2e-16 ***
ORIGIN_ID1313         0.5077618  0.1345998     3.772 0.000162 ***
ORIGIN_ID1314         3.1463811  0.1271077    24.754  &lt; 2e-16 ***
ORIGIN_ID1315         2.8176523  0.1273017    22.134  &lt; 2e-16 ***
ORIGIN_ID1316         2.5639319  0.1273185    20.138  &lt; 2e-16 ***
ORIGIN_ID1317         1.8462268  0.1277231    14.455  &lt; 2e-16 ***
ORIGIN_ID1320        -0.6678915  0.1590704    -4.199 2.68e-05 ***
ORIGIN_ID1325         2.4139517  0.1278283    18.884  &lt; 2e-16 ***
ORIGIN_ID1326         3.2808586  0.1270695    25.819  &lt; 2e-16 ***
ORIGIN_ID1327         4.2237788  0.1270330    33.249  &lt; 2e-16 ***
ORIGIN_ID1328         3.6227917  0.1270912    28.505  &lt; 2e-16 ***
ORIGIN_ID1329         2.1979614  0.1273343    17.261  &lt; 2e-16 ***
ORIGIN_ID1330         2.7601526  0.1272081    21.698  &lt; 2e-16 ***
ORIGIN_ID1331         3.8498660  0.1270728    30.297  &lt; 2e-16 ***
ORIGIN_ID1332         1.0158915  0.1302939     7.797 6.34e-15 ***
ORIGIN_ID1333         3.3819652  0.1271440    26.599  &lt; 2e-16 ***
ORIGIN_ID1334         0.3240157  0.1314527     2.465 0.013706 *  
ORIGIN_ID1338        -1.0834717  0.2877423    -3.765 0.000166 ***
ORIGIN_ID1339         3.1260229  0.1274433    24.529  &lt; 2e-16 ***
ORIGIN_ID1341         2.6325102  0.1273456    20.672  &lt; 2e-16 ***
ORIGIN_ID1342         4.0076901  0.1270475    31.545  &lt; 2e-16 ***
ORIGIN_ID1343         3.6365047  0.1270686    28.618  &lt; 2e-16 ***
ORIGIN_ID1344         4.3699239  0.1270249    34.402  &lt; 2e-16 ***
ORIGIN_ID1345         3.0750059  0.1271257    24.189  &lt; 2e-16 ***
ORIGIN_ID1346         3.5711345  0.1271034    28.096  &lt; 2e-16 ***
ORIGIN_ID1347         3.7901464  0.1270784    29.825  &lt; 2e-16 ***
ORIGIN_ID1348         3.9742136  0.1270747    31.275  &lt; 2e-16 ***
ORIGIN_ID1349         0.2426008  0.1357495     1.787 0.073918 .  
ORIGIN_ID1355         2.2165113  0.1279491    17.323  &lt; 2e-16 ***
ORIGIN_ID1356         3.8052616  0.1270428    29.953  &lt; 2e-16 ***
ORIGIN_ID1357         1.6804654  0.1280323    13.125  &lt; 2e-16 ***
ORIGIN_ID1358         3.8279489  0.1270946    30.119  &lt; 2e-16 ***
ORIGIN_ID1359         2.9269704  0.1271186    23.026  &lt; 2e-16 ***
ORIGIN_ID1360         2.9499389  0.1271405    23.202  &lt; 2e-16 ***
ORIGIN_ID1361         4.3636332  0.1270311    34.351  &lt; 2e-16 ***
ORIGIN_ID1362         3.1813576  0.1271333    25.024  &lt; 2e-16 ***
ORIGIN_ID1363         4.3111122  0.1270514    33.932  &lt; 2e-16 ***
ORIGIN_ID1364        -0.4311362  0.1457987    -2.957 0.003106 ** 
ORIGIN_ID1370         2.2204687  0.1273232    17.440  &lt; 2e-16 ***
ORIGIN_ID1371         3.7590399  0.1270667    29.583  &lt; 2e-16 ***
ORIGIN_ID1372         2.9120081  0.1271218    22.907  &lt; 2e-16 ***
ORIGIN_ID1373         2.8624954  0.1272811    22.490  &lt; 2e-16 ***
ORIGIN_ID1374         3.4610219  0.1270734    27.236  &lt; 2e-16 ***
ORIGIN_ID1376         4.4955272  0.1270282    35.390  &lt; 2e-16 ***
ORIGIN_ID1377         0.5051395  0.1338103     3.775 0.000160 ***
ORIGIN_ID1378         1.9784362  0.1310624    15.095  &lt; 2e-16 ***
ORIGIN_ID1383         1.9650366  0.1280057    15.351  &lt; 2e-16 ***
ORIGIN_ID1384         3.6072211  0.1270654    28.389  &lt; 2e-16 ***
ORIGIN_ID1385         3.0205897  0.1271183    23.762  &lt; 2e-16 ***
ORIGIN_ID1386         2.3120349  0.1274670    18.138  &lt; 2e-16 ***
ORIGIN_ID1387         2.8443262  0.1271724    22.366  &lt; 2e-16 ***
ORIGIN_ID1388         2.0053149  0.1275330    15.724  &lt; 2e-16 ***
ORIGIN_ID1389         4.2705168  0.1270475    33.614  &lt; 2e-16 ***
ORIGIN_ID1390         4.4690900  0.1270498    35.176  &lt; 2e-16 ***
ORIGIN_ID1391         3.6849497  0.1271110    28.990  &lt; 2e-16 ***
ORIGIN_ID1396         3.6147483  0.1270796    28.445  &lt; 2e-16 ***
ORIGIN_ID1397         3.5683498  0.1270707    28.082  &lt; 2e-16 ***
ORIGIN_ID1398         3.6279096  0.1270623    28.552  &lt; 2e-16 ***
ORIGIN_ID1399         2.2934203  0.1272484    18.023  &lt; 2e-16 ***
ORIGIN_ID1400         4.2959908  0.1270537    33.812  &lt; 2e-16 ***
ORIGIN_ID1401         2.8093724  0.1272058    22.085  &lt; 2e-16 ***
ORIGIN_ID1402         4.7554450  0.1270306    37.435  &lt; 2e-16 ***
ORIGIN_ID1403         3.1494404  0.1272338    24.753  &lt; 2e-16 ***
ORIGIN_ID1408         2.9051531  0.1272615    22.828  &lt; 2e-16 ***
ORIGIN_ID1409         3.8146096  0.1270535    30.024  &lt; 2e-16 ***
ORIGIN_ID1410         3.2664272  0.1270797    25.704  &lt; 2e-16 ***
ORIGIN_ID1411         3.3098963  0.1270722    26.047  &lt; 2e-16 ***
ORIGIN_ID1412         0.8610867  0.1286327     6.694 2.17e-11 ***
ORIGIN_ID1413         3.6044057  0.1270831    28.363  &lt; 2e-16 ***
ORIGIN_ID1414         4.3666110  0.1270261    34.376  &lt; 2e-16 ***
ORIGIN_ID1415         3.5403772  0.1271208    27.850  &lt; 2e-16 ***
ORIGIN_ID1416         4.7493550  0.1270426    37.384  &lt; 2e-16 ***
ORIGIN_ID1417         4.6691612  0.1273208    36.672  &lt; 2e-16 ***
ORIGIN_ID1421         2.4175803  0.1273721    18.980  &lt; 2e-16 ***
ORIGIN_ID1422         3.7112401  0.1270482    29.211  &lt; 2e-16 ***
ORIGIN_ID1423         2.6408477  0.1271546    20.769  &lt; 2e-16 ***
ORIGIN_ID1424         0.3422708  0.1297353     2.638 0.008334 ** 
ORIGIN_ID1425         3.6679953  0.1270697    28.866  &lt; 2e-16 ***
ORIGIN_ID1426         4.3183233  0.1270306    33.994  &lt; 2e-16 ***
ORIGIN_ID1427         4.3020260  0.1270393    33.864  &lt; 2e-16 ***
ORIGIN_ID1428         3.9331905  0.1270626    30.955  &lt; 2e-16 ***
ORIGIN_ID1429         4.0969207  0.1270817    32.238  &lt; 2e-16 ***
ORIGIN_ID1432         2.5567306  0.1274034    20.068  &lt; 2e-16 ***
ORIGIN_ID1433         3.1950217  0.1271326    25.131  &lt; 2e-16 ***
ORIGIN_ID1434         0.2887252  0.1315608     2.195 0.028191 *  
ORIGIN_ID1435         1.8526341  0.1273708    14.545  &lt; 2e-16 ***
ORIGIN_ID1436        -1.9525421  0.2224013    -8.779  &lt; 2e-16 ***
ORIGIN_ID1437         3.3568121  0.1271141    26.408  &lt; 2e-16 ***
ORIGIN_ID1438         3.9710021  0.1270466    31.256  &lt; 2e-16 ***
ORIGIN_ID1439         3.9680556  0.1270565    31.231  &lt; 2e-16 ***
ORIGIN_ID1440         4.4418776  0.1270320    34.967  &lt; 2e-16 ***
ORIGIN_ID1441         4.4738059  0.1270493    35.213  &lt; 2e-16 ***
ORIGIN_ID1444         2.9031626  0.1271688    22.829  &lt; 2e-16 ***
ORIGIN_ID1445         3.6993628  0.1270527    29.117  &lt; 2e-16 ***
ORIGIN_ID1446         3.3880119  0.1271014    26.656  &lt; 2e-16 ***
ORIGIN_ID1447         2.2883174  0.1276637    17.925  &lt; 2e-16 ***
ORIGIN_ID1448         1.3237578  0.1297128    10.205  &lt; 2e-16 ***
ORIGIN_ID1449         2.4961044  0.1273218    19.605  &lt; 2e-16 ***
ORIGIN_ID1450         4.0837973  0.1270506    32.143  &lt; 2e-16 ***
ORIGIN_ID1451         4.4417178  0.1270355    34.964  &lt; 2e-16 ***
ORIGIN_ID1452         3.4861374  0.1271574    27.416  &lt; 2e-16 ***
ORIGIN_ID1453         3.7596320  0.1271986    29.557  &lt; 2e-16 ***
ORIGIN_ID1455         3.1136237  0.1271979    24.479  &lt; 2e-16 ***
ORIGIN_ID1456         3.4698384  0.1271799    27.283  &lt; 2e-16 ***
ORIGIN_ID1457         3.1422296  0.1271097    24.721  &lt; 2e-16 ***
ORIGIN_ID1458         2.7511948  0.1271441    21.638  &lt; 2e-16 ***
ORIGIN_ID1459         1.6090266  0.1292767    12.446  &lt; 2e-16 ***
ORIGIN_ID1461         2.7519592  0.1276072    21.566  &lt; 2e-16 ***
ORIGIN_ID1462         3.6705530  0.1270966    28.880  &lt; 2e-16 ***
ORIGIN_ID1463         5.0732737  0.1270209    39.940  &lt; 2e-16 ***
ORIGIN_ID1464         4.3685263  0.1270392    34.387  &lt; 2e-16 ***
ORIGIN_ID1465         3.6453318  0.1273008    28.636  &lt; 2e-16 ***
ORIGIN_ID1466         3.8433786  0.1270562    30.249  &lt; 2e-16 ***
ORIGIN_ID1467         4.0137143  0.1270372    31.595  &lt; 2e-16 ***
ORIGIN_ID1468         4.1146732  0.1270347    32.390  &lt; 2e-16 ***
ORIGIN_ID1471         0.8842959  0.1302721     6.788 1.14e-11 ***
ORIGIN_ID1472         4.0075659  0.1271090    31.529  &lt; 2e-16 ***
ORIGIN_ID1473         4.1312330  0.1270684    32.512  &lt; 2e-16 ***
ORIGIN_ID1474         5.2520089  0.1270201    41.348  &lt; 2e-16 ***
ORIGIN_ID1475         1.0562848  0.1317369     8.018 1.07e-15 ***
ORIGIN_ID1478         3.2491009  0.1271066    25.562  &lt; 2e-16 ***
ORIGIN_ID1479         2.5315783  0.1278858    19.796  &lt; 2e-16 ***
ORIGIN_ID1480         3.7206255  0.1270729    29.279  &lt; 2e-16 ***
ORIGIN_ID1483         1.2219176  0.1293872     9.444  &lt; 2e-16 ***
ORIGIN_ID1485         3.8908692  0.1271072    30.611  &lt; 2e-16 ***
ORIGIN_ID1486         2.7541672  0.1275024    21.601  &lt; 2e-16 ***
ORIGIN_ID1487         0.9497121  0.1318780     7.201 5.96e-13 ***
ORIGIN_ID1488         4.1209705  0.1270451    32.437  &lt; 2e-16 ***
ORIGIN_ID1489         2.3373399  0.1273054    18.360  &lt; 2e-16 ***
ORIGIN_ID1490         4.1742556  0.1270657    32.851  &lt; 2e-16 ***
ORIGIN_ID1491         0.0053187  0.1337869     0.040 0.968289    
ORIGIN_ID1494        -1.3576707  0.1984561    -6.841 7.86e-12 ***
ORIGIN_ID1495         2.7096032  0.1277142    21.216  &lt; 2e-16 ***
ORIGIN_ID1496         3.8586505  0.1271063    30.358  &lt; 2e-16 ***
ORIGIN_ID1500         2.8269700  0.1272152    22.222  &lt; 2e-16 ***
ORIGIN_ID1501         3.6605537  0.1270721    28.807  &lt; 2e-16 ***
ORIGIN_ID1502         3.9598111  0.1270522    31.167  &lt; 2e-16 ***
ORIGIN_ID1506        -2.2228460  0.4648968    -4.781 1.74e-06 ***
ORIGIN_ID1507         3.7665483  0.1271175    29.630  &lt; 2e-16 ***
ORIGIN_ID1508         4.3832027  0.1271563    34.471  &lt; 2e-16 ***
ORIGIN_ID1510         2.9944523  0.1271827    23.544  &lt; 2e-16 ***
ORIGIN_ID1511         2.2692734  0.1275713    17.788  &lt; 2e-16 ***
ORIGIN_ID1512         3.5308341  0.1272213    27.753  &lt; 2e-16 ***
ORIGIN_ID1513         2.3608847  0.1274068    18.530  &lt; 2e-16 ***
ORIGIN_ID1516         1.2397265  0.1295010     9.573  &lt; 2e-16 ***
ORIGIN_ID1518         3.6437012  0.1272101    28.643  &lt; 2e-16 ***
ORIGIN_ID1521         2.9949692  0.1271666    23.552  &lt; 2e-16 ***
ORIGIN_ID1522         3.8543783  0.1270565    30.336  &lt; 2e-16 ***
ORIGIN_ID1523         3.5510428  0.1271222    27.934  &lt; 2e-16 ***
ORIGIN_ID1526         0.2539764  0.1414390     1.796 0.072549 .  
ORIGIN_ID1530         2.8414581  0.1273233    22.317  &lt; 2e-16 ***
ORIGIN_ID1531         2.4386236  0.1278125    19.080  &lt; 2e-16 ***
ORIGIN_ID1532         4.5940696  0.1270358    36.164  &lt; 2e-16 ***
ORIGIN_ID1533         3.0004773  0.1272271    23.584  &lt; 2e-16 ***
ORIGIN_ID1534         2.5512331  0.1277818    19.966  &lt; 2e-16 ***
ORIGIN_ID1535         1.3156230  0.1292030    10.183  &lt; 2e-16 ***
ORIGIN_ID1536         0.0733035  0.1514324     0.484 0.628338    
ORIGIN_ID1541         3.0017576  0.1271631    23.606  &lt; 2e-16 ***
ORIGIN_ID1542         4.5551354  0.1270211    35.861  &lt; 2e-16 ***
ORIGIN_ID1543         4.0620409  0.1270821    31.964  &lt; 2e-16 ***
ORIGIN_ID1544         4.1675465  0.1270628    32.799  &lt; 2e-16 ***
ORIGIN_ID1545         2.6593230  0.1273542    20.881  &lt; 2e-16 ***
ORIGIN_ID1546         2.6903094  0.1274033    21.116  &lt; 2e-16 ***
ORIGIN_ID1553         2.5845333  0.1272404    20.312  &lt; 2e-16 ***
ORIGIN_ID1554         4.0282130  0.1270495    31.706  &lt; 2e-16 ***
ORIGIN_ID1555         3.0974303  0.1271402    24.362  &lt; 2e-16 ***
ORIGIN_ID1556         4.7929864  0.1270362    37.729  &lt; 2e-16 ***
ORIGIN_ID1557         3.1475448  0.1271539    24.754  &lt; 2e-16 ***
ORIGIN_ID1558         3.8778247  0.1270765    30.516  &lt; 2e-16 ***
ORIGIN_ID1562         2.9764179  0.1271775    23.404  &lt; 2e-16 ***
ORIGIN_ID1563         3.9475608  0.1270503    31.071  &lt; 2e-16 ***
ORIGIN_ID1564         4.2724933  0.1270440    33.630  &lt; 2e-16 ***
ORIGIN_ID1565         3.4004531  0.1271054    26.753  &lt; 2e-16 ***
ORIGIN_ID1566         4.7145981  0.1270318    37.114  &lt; 2e-16 ***
ORIGIN_ID1568         4.1691438  0.1270636    32.811  &lt; 2e-16 ***
ORIGIN_ID1573         3.4702477  0.1270989    27.304  &lt; 2e-16 ***
ORIGIN_ID1574         4.4771400  0.1270584    35.237  &lt; 2e-16 ***
ORIGIN_ID1575         0.5196106  0.1295217     4.012 6.03e-05 ***
ORIGIN_ID1576         3.6374708  0.1270651    28.627  &lt; 2e-16 ***
ORIGIN_ID1577         3.8886397  0.1271045    30.594  &lt; 2e-16 ***
ORIGIN_ID1578         4.4062761  0.1270529    34.681  &lt; 2e-16 ***
ORIGIN_ID1584         4.0688838  0.1270496    32.026  &lt; 2e-16 ***
ORIGIN_ID1585         2.8218315  0.1274290    22.144  &lt; 2e-16 ***
ORIGIN_ID1586         4.1925542  0.1270353    33.003  &lt; 2e-16 ***
ORIGIN_ID1587         4.1679381  0.1270428    32.807  &lt; 2e-16 ***
ORIGIN_ID1588         3.0904462  0.1273884    24.260  &lt; 2e-16 ***
ORIGIN_ID1589         3.6704171  0.1271401    28.869  &lt; 2e-16 ***
ORIGIN_ID1593         3.7286203  0.1270869    29.339  &lt; 2e-16 ***
ORIGIN_ID1594         4.3042033  0.1270418    33.880  &lt; 2e-16 ***
ORIGIN_ID1595         2.5431429  0.1272413    19.987  &lt; 2e-16 ***
ORIGIN_ID1596         4.6728384  0.1270195    36.788  &lt; 2e-16 ***
ORIGIN_ID1597         3.2574485  0.1272692    25.595  &lt; 2e-16 ***
ORIGIN_ID1598         3.8080059  0.1270810    29.965  &lt; 2e-16 ***
ORIGIN_ID1602         0.2583432  0.1607414     1.607 0.108011    
ORIGIN_ID1603         1.9213685  0.1287457    14.924  &lt; 2e-16 ***
ORIGIN_ID1604         2.7207131  0.1272092    21.388  &lt; 2e-16 ***
ORIGIN_ID1605         3.3616678  0.1271078    26.447  &lt; 2e-16 ***
ORIGIN_ID1606         3.9205925  0.1270615    30.856  &lt; 2e-16 ***
ORIGIN_ID1607         3.9061577  0.1270723    30.740  &lt; 2e-16 ***
ORIGIN_ID1608         1.4907511  0.1298102    11.484  &lt; 2e-16 ***
ORIGIN_ID1611         1.2801049  0.1282147     9.984  &lt; 2e-16 ***
ORIGIN_ID1612         1.8812793  0.1275552    14.749  &lt; 2e-16 ***
ORIGIN_ID1613         3.6645695  0.1270993    28.832  &lt; 2e-16 ***
ORIGIN_ID1614         4.3232353  0.1270366    34.031  &lt; 2e-16 ***
ORIGIN_ID1615         4.1568243  0.1270872    32.708  &lt; 2e-16 ***
ORIGIN_ID1616         4.1846343  0.1270457    32.938  &lt; 2e-16 ***
ORIGIN_ID1620         2.6254103  0.1274353    20.602  &lt; 2e-16 ***
ORIGIN_ID1621         1.4154199  0.1279750    11.060  &lt; 2e-16 ***
ORIGIN_ID1622         3.9502948  0.1270699    31.088  &lt; 2e-16 ***
ORIGIN_ID1623         4.6923359  0.1270239    36.941  &lt; 2e-16 ***
ORIGIN_ID1624         4.4411610  0.1270434    34.958  &lt; 2e-16 ***
ORIGIN_ID1629         1.7298705  0.1281336    13.501  &lt; 2e-16 ***
ORIGIN_ID1630         3.3489166  0.1271230    26.344  &lt; 2e-16 ***
ORIGIN_ID1631         4.3047678  0.1270943    33.871  &lt; 2e-16 ***
ORIGIN_ID1632         3.7253492  0.1270792    29.315  &lt; 2e-16 ***
ORIGIN_ID1633         4.1958940  0.1270625    33.022  &lt; 2e-16 ***
ORIGIN_ID1638         3.2369634  0.1271949    25.449  &lt; 2e-16 ***
ORIGIN_ID1639         2.7042905  0.1273418    21.236  &lt; 2e-16 ***
ORIGIN_ID1640         3.8346562  0.1270707    30.177  &lt; 2e-16 ***
ORIGIN_ID1641         3.9675362  0.1270758    31.222  &lt; 2e-16 ***
ORIGIN_ID1642         3.7333405  0.1285484    29.042  &lt; 2e-16 ***
ORIGIN_ID1646         0.0383803  0.1340674     0.286 0.774667    
ORIGIN_ID1647        -1.0126516  0.1444589    -7.010 2.38e-12 ***
ORIGIN_ID1648         2.1448354  0.1275198    16.820  &lt; 2e-16 ***
ORIGIN_ID1649         3.1855347  0.1271213    25.059  &lt; 2e-16 ***
ORIGIN_ID1654         0.7080401  0.1298922     5.451 5.01e-08 ***
ORIGIN_ID1655         2.3119059  0.1282506    18.026  &lt; 2e-16 ***
ORIGIN_ID1656         3.1472662  0.1272054    24.742  &lt; 2e-16 ***
ORIGIN_ID1657         2.8719948  0.1272506    22.570  &lt; 2e-16 ***
ORIGIN_ID1658         0.1716435  0.1467461     1.170 0.242137    
ORIGIN_ID1664         0.6552960  0.1328752     4.932 8.15e-07 ***
ORIGIN_ID1665         1.1780310  0.1287992     9.146  &lt; 2e-16 ***
ORIGIN_ID1666         1.3158320  0.1281558    10.267  &lt; 2e-16 ***
ORIGIN_ID1667         1.1992240  0.1324897     9.051  &lt; 2e-16 ***
ORIGIN_ID1674         2.4657081  0.1283346    19.213  &lt; 2e-16 ***
ORIGIN_ID1675         1.9700446  0.1279462    15.397  &lt; 2e-16 ***
ORIGIN_ID1676         0.0565494  0.1317884     0.429 0.667856    
ORIGIN_ID1682         3.1771060  0.1272756    24.962  &lt; 2e-16 ***
ORIGIN_ID1685         1.3226821  0.1281401    10.322  &lt; 2e-16 ***
ORIGIN_ID1686         1.4301886  0.1282696    11.150  &lt; 2e-16 ***
ORIGIN_ID1691         1.7180367  0.1283738    13.383  &lt; 2e-16 ***
ORIGIN_ID1693        -0.2024503  0.1437862    -1.408 0.159133    
ORIGIN_ID1695         0.7855914  0.1360099     5.776 7.65e-09 ***
ORIGIN_ID1698         3.9650265  0.1278282    31.018  &lt; 2e-16 ***
ORIGIN_ID1704         2.8009019  0.1272805    22.006  &lt; 2e-16 ***
ORIGIN_ID1711         4.1393935  0.1271214    32.563  &lt; 2e-16 ***
ORIGIN_ID1714        -1.5336257  0.2959015    -5.183 2.18e-07 ***
ORIGIN_ID1722         2.2828952  0.1277933    17.864  &lt; 2e-16 ***
ORIGIN_ID1723        -1.1274583  0.1711343    -6.588 4.45e-11 ***
ORIGIN_ID1726         3.8442425  0.1280245    30.027  &lt; 2e-16 ***
ORIGIN_ID1731         2.1802950  0.1285277    16.964  &lt; 2e-16 ***
ORIGIN_ID1732         1.8254146  0.1288448    14.168  &lt; 2e-16 ***
ORIGIN_ID1741         1.1855243  0.1303904     9.092  &lt; 2e-16 ***
ORIGIN_ID1742         3.1286062  0.1273755    24.562  &lt; 2e-16 ***
ORIGIN_ID1750         1.6175945  0.1339425    12.077  &lt; 2e-16 ***
ORIGIN_ID1751         1.1680194  0.1393892     8.380  &lt; 2e-16 ***
ORIGIN_ID1768         2.7389901  0.1326800    20.644  &lt; 2e-16 ***
log(DESTIN_BUSINESS)  0.1016894  0.0001638   620.671  &lt; 2e-16 ***
log(dist)            -1.0393266  0.0001750 -5940.169  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 103028979  on 65699  degrees of freedom
Residual deviance:  51370841  on 64878  degrees of freedom
AIC: 51734239

Number of Fisher Scoring iterations: 7</code></pre>
</div>
</div>
</div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>